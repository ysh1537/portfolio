import{t as c,z as e,an as N,ao as A,ap as k,aq as G,ar as L,a7 as w,a9 as S,$ as I,a3 as D,u as O,n as U,m as P,C as v,w as T,a5 as H,J as j,K as B}from"./three-DS91w7Dj.js";import{a as K}from"./index-Ca8MP01F.js";import{g as $,i as Y,q as z,l as F,o as X,c as C,a as Z,b as _,s as q}from"./firebase-Gy-nhAmo.js";import"./vendor-CqO7gtIP.js";import"./animation-8i8s5thx.js";import"./postprocessing-DuwpyNE2.js";import"./sanity-BYUyb1Ps.js";const W={apiKey:"AIzaSyDSFXuCK0G6l1qaEeHRibMUYfKarOZtZYw",authDomain:"portfolio-guestbook-5ee79.firebaseapp.com",projectId:"portfolio-guestbook-5ee79",storageBucket:"portfolio-guestbook-5ee79.firebasestorage.app",messagingSenderId:"341239700624",appId:"1:341239700624:web:ac6b3a4e2984a6d83dcc15"},V=Y(W),R=$(V),J=()=>{const[i,a]=c.useState([]),[d,p]=c.useState(""),[s,l]=c.useState(""),[r,u]=c.useState(!1),[o,x]=c.useState(null);c.useEffect(()=>{const n=z(C(R,"guestbook"),X("createdAt","desc"),F(50)),m=Z(n,t=>{const b=t.docs.map(h=>({id:h.id,...h.data()}));a(b)},t=>{console.error("[Guestbook] ë¡œë“œ ì‹¤íŒ¨:",t),x("ë°©ëª…ë¡ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")});return()=>m()},[]);const f=async n=>{if(n.preventDefault(),!d.trim()||!s.trim()){x("ë‹‰ë„¤ì„ê³¼ ë©”ì‹œì§€ë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.");return}if(d.length>20||s.length>500){x("ë‹‰ë„¤ì„ì€ 20ì, ë©”ì‹œì§€ëŠ” 500ì ì´ë‚´ë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”.");return}u(!0),x(null);try{await _(C(R,"guestbook"),{nickname:d.trim(),message:s.trim(),createdAt:q()}),p(""),l("")}catch(m){console.error("[Guestbook] ì‘ì„± ì‹¤íŒ¨:",m),x("ë°©ëª…ë¡ ì‘ì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.")}finally{u(!1)}},g=n=>{if(!n)return"";const m=n.toDate();return new Intl.DateTimeFormat("ko-KR",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(m)};return e.jsxs("div",{className:"w-full h-full flex flex-col text-white font-mono",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("h3",{className:"text-cyan-400 font-bold text-lg mb-1",children:"ğŸ“ GUESTBOOK UNLOCKED"}),e.jsx("p",{className:"text-gray-400 text-xs",children:"ì„¹í„° ì•ˆì •í™”ì— ì„±ê³µí•˜ì…¨êµ°ìš”! ë°©ëª…ë¡ì„ ë‚¨ê²¨ì£¼ì„¸ìš”."})]}),e.jsxs("form",{onSubmit:f,className:"mb-4 space-y-2",children:[e.jsx("input",{type:"text",placeholder:"ë‹‰ë„¤ì„ (ìµœëŒ€ 20ì)",value:d,onChange:n=>p(n.target.value),maxLength:20,className:"w-full px-3 py-2 bg-black/50 border border-cyan-500/30 rounded text-sm text-white placeholder-gray-500 focus:outline-none focus:border-cyan-400"}),e.jsx("textarea",{placeholder:"ë©”ì‹œì§€ë¥¼ ë‚¨ê²¨ì£¼ì„¸ìš” (ìµœëŒ€ 500ì)",value:s,onChange:n=>l(n.target.value),maxLength:500,rows:3,className:"w-full px-3 py-2 bg-black/50 border border-cyan-500/30 rounded text-sm text-white placeholder-gray-500 focus:outline-none focus:border-cyan-400 resize-none"}),o&&e.jsx("p",{className:"text-red-400 text-xs",children:o}),e.jsx("button",{type:"submit",disabled:r,className:`w-full py-2 rounded text-sm font-bold transition-all ${r?"bg-gray-700 text-gray-400 cursor-not-allowed":"bg-cyan-600 text-white hover:bg-cyan-500"}`,children:r?"ì „ì†¡ ì¤‘...":"ë°©ëª…ë¡ ë‚¨ê¸°ê¸°"})]}),e.jsx("div",{className:"flex-1 overflow-y-auto space-y-2 pr-1",children:i.length===0?e.jsx("p",{className:"text-gray-500 text-center text-sm py-4",children:"ì•„ì§ ë°©ëª…ë¡ì´ ì—†ìŠµë‹ˆë‹¤. ì²« ë²ˆì§¸ë¡œ ë‚¨ê²¨ë³´ì„¸ìš”!"}):i.map(n=>e.jsxs("div",{className:"p-3 bg-black/40 border border-cyan-500/20 rounded",children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"text-cyan-300 font-bold text-sm",children:n.nickname}),e.jsx("span",{className:"text-gray-500 text-xs",children:g(n.createdAt)})]}),e.jsx("p",{className:"text-gray-200 text-sm whitespace-pre-wrap break-words",children:n.message})]},n.id))})]})},M={vertexShader:`
        varying vec2 vUv;
        void main() {
            vUv = uv;
            gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
        }
    `,fragmentShader:`
        varying vec2 vUv;
        uniform float uTime;
        uniform vec3 uColor;
        uniform float uSpeed;

        float random(vec2 st) {
            return fract(sin(dot(st.xy, vec2(12.9898,78.233))) * 43758.5453123);
        }

        void main() {
            vec2 uv = vUv;
            float columns = 50.0;
            vec2 ipos = floor(uv * columns);
            // ì†ë„ ì ˆë°˜ìœ¼ë¡œ ì¤„ì„ (0.5~1.5)
            float baseSpeed = 0.5 + random(vec2(ipos.x, 0.0)) * 1.0;
            float y = mod(uv.y + uTime * baseSpeed * 0.1 * uSpeed, 1.0);
            float strength = 1.0 - step(0.1, random(vec2(ipos.x, floor(y * 20.0))));
            strength *= (1.0 - fract(y * 10.0));
            float head = 1.0 - step(0.01, y); 
            vec3 color = uColor * strength;
            color += vec3(0.8, 1.0, 0.8) * head;
            gl_FragColor = vec4(color, strength * 0.7);
        }
    `},Q=({stabilized:i})=>{const a=c.useRef(),{viewport:d}=O(),p=c.useRef(0),s=c.useMemo(()=>new U({uniforms:{uTime:{value:0},uColor:{value:new v("#ef4444")},uSpeed:{value:1}},vertexShader:M.vertexShader,fragmentShader:M.fragmentShader,transparent:!0,depthWrite:!1,side:P}),[]);return T((l,r)=>{if(a.current&&a.current.material&&a.current.material.uniforms){const u=a.current.material.uniforms;i?(p.current===0&&(p.current=l.clock.elapsedTime),u.uTime.value=p.current,u.uSpeed.value=j.lerp(u.uSpeed.value,0,r*2)):(u.uTime.value=l.clock.getElapsedTime(),u.uSpeed.value=1);const o=i?new v("#06b6d4"):new v("#ef4444");u.uColor.value.lerp(o,r*2)}}),e.jsxs("mesh",{ref:a,scale:[d.width,d.height,1],position:[0,0,-5],children:[e.jsx("planeGeometry",{args:[1,1]}),e.jsx("primitive",{object:s,attach:"material"})]})},ee=({text:i,position:a,fontSize:d,color:p,intensity:s=1})=>{const l=c.useRef();return T(()=>{l.current&&(Math.random()>1-.05*s?(l.current.position.x=a[0]+(Math.random()-.5)*.1*s,l.current.position.y=a[1]+(Math.random()-.5)*.1*s):l.current.position.set(...a))}),e.jsxs("group",{ref:l,position:a,children:[e.jsx(S,{position:[.02*s,0,0],fontSize:d,color:"cyan",opacity:.5,anchorX:"center",children:i}),e.jsx(S,{position:[-.02*s,0,0],fontSize:d,color:"red",opacity:.5,anchorX:"center",children:i}),e.jsx(S,{position:[0,0,0],fontSize:d,color:p,anchorX:"center",children:i})]})},y=({id:i,position:a,geometry:d,onPatch:p,isPatched:s,speed:l=2})=>{const r=c.useRef(),[u,o]=c.useState(!1),{playHover:x,playClick:f}=K();T((n,m)=>{if(!r.current)return;s?(r.current.rotation.x+=m*.3,r.current.rotation.y+=m*.2,r.current.position.x=j.lerp(r.current.position.x,a[0],m*5),r.current.position.y=j.lerp(r.current.position.y,a[1],m*5)):(r.current.rotation.x+=m*l*(.5+Math.sin(n.clock.elapsedTime*5)*.3),r.current.rotation.y+=m*l*(.5+Math.cos(n.clock.elapsedTime*4)*.3),Math.random()>.9&&(r.current.position.x=a[0]+(Math.random()-.5)*.2,r.current.position.y=a[1]+(Math.random()-.5)*.2));const t=u?1.3:1;r.current.scale.lerp(new B(t,t,t),.1)});const g=()=>{s||(f(),p(i))};return e.jsx(H,{speed:s?2:8,rotationIntensity:s?1:4,floatIntensity:1,children:e.jsxs("mesh",{ref:r,position:a,onPointerOver:()=>{s||(o(!0),x(),document.body.style.cursor="pointer")},onPointerOut:()=>{o(!1),document.body.style.cursor="auto"},onClick:g,children:[e.jsx("primitive",{object:d,attach:"geometry"}),e.jsx("meshBasicMaterial",{color:s?"#06b6d4":u?"#ffffff":"#ef4444",wireframe:!0,transparent:!0,opacity:s?.8:u?.9:.5})]})})},ie=()=>{const[i,a]=c.useState(new Set),[d,p]=c.useState(["[SYSTEM] CRITICAL FAILURE IN SECTOR 04","[KERNEL] REALITY INTEGRITY: 12%","[WARNING] DATA CORRUPTION DETECTED"]),s=4,l=12,r=Math.floor((100-l)/s),u=l+i.size*r,o=i.size>=s,x=c.useCallback(t=>{a(h=>{const E=new Set(h);return E.add(t),E});const b={"mod-1":"QUANTUM_CORE","mod-2":"NEURAL_LINK","mod-3":"MEMORY_STACK","mod-4":"REALITY_ANCHOR"};p(h=>[...h,`[PATCHING] ${b[t]||t}...`,`[SUCCESS] Module restored. Integrity +${r}%`])},[r]);c.useEffect(()=>{o&&p(t=>[...t,"[SYSTEM] ALL MODULES RESTORED","[STATUS] SECTOR STABILIZED","",'>>> "Debugging is Creating." <<<'])},[o]);const f=c.useMemo(()=>new N(.8,0),[]),g=c.useMemo(()=>new A(.5,.15,64,12),[]),n=c.useMemo(()=>new k(.7,0),[]),m=c.useMemo(()=>new G(.6,0),[]);return e.jsxs("group",{children:[e.jsx(Q,{stabilized:o}),e.jsxs("group",{position:[0,0,0],children:[e.jsxs("mesh",{position:[0,0,-1],children:[e.jsx("planeGeometry",{args:[6,4]}),e.jsx("meshBasicMaterial",{color:"#000000",transparent:!0,opacity:.9}),e.jsxs("lineSegments",{children:[e.jsx("edgesGeometry",{args:[new L(6,4)]}),e.jsx("meshBasicMaterial",{color:o?"#06b6d4":"#ef4444"})]})]}),e.jsx(w,{children:e.jsx(ee,{text:o?"SECTOR STABILIZED":"THE GLITCH [FATAL ERROR]",position:[0,1.5,0],fontSize:.3,color:o?"#06b6d4":"#ef4444",intensity:o?.1:1})}),e.jsx(w,{children:e.jsxs(S,{position:[0,1.1,0],fontSize:.15,color:o?"#06b6d4":"#fbbf24",anchorX:"center",children:["REALITY INTEGRITY: ",u,"%"]})}),e.jsx(I,{position:[-2.5,.8,0],transform:!0,scale:.5,style:{width:"800px",maxHeight:"350px",overflow:"hidden",pointerEvents:"none"},children:e.jsxs("div",{className:"font-mono text-sm leading-relaxed",children:[d.map((t,b)=>e.jsx("p",{className:`
                                ${t.includes("SUCCESS")?"text-emerald-400":""}
                                ${t.includes("PATCHING")?"text-yellow-400":""}
                                ${t.includes("CRITICAL")||t.includes("ERROR")?"text-red-500":""}
                                ${t.includes("STABILIZED")?"text-cyan-400 font-bold":""}
                                ${t.includes("Debugging")?"text-white text-lg font-bold mt-4 animate-pulse":""}
                                ${!t.includes("SUCCESS")&&!t.includes("PATCHING")&&!t.includes("CRITICAL")&&!t.includes("ERROR")&&!t.includes("STABILIZED")&&!t.includes("Debugging")?"text-red-400 opacity-70":""}
                            `,children:t.startsWith("[")?`> ${t}`:t},b)),!o&&e.jsx("p",{className:"text-yellow-500 animate-pulse mt-4",children:"> [HINT] ë¶ˆì•ˆì •í•œ ëª¨ë“ˆì„ í´ë¦­í•˜ì—¬ íŒ¨ì¹˜í•˜ì„¸ìš”..."})]})}),o&&e.jsx(I,{position:[0,-2.5,0],transform:!0,scale:.4,style:{width:"600px",maxHeight:"400px",overflow:"auto",background:"rgba(0, 0, 0, 0.9)",borderRadius:"12px",border:"1px solid rgba(6, 182, 212, 0.3)",padding:"16px"},children:e.jsx(J,{})})]}),e.jsx(y,{id:"mod-1",position:[3.5,.8,1],geometry:f,onPatch:x,isPatched:i.has("mod-1"),speed:3}),e.jsx(y,{id:"mod-2",position:[-5,1.5,3],geometry:g,onPatch:x,isPatched:i.has("mod-2"),speed:4}),e.jsx(y,{id:"mod-3",position:[3.5,-1.2,1],geometry:n,onPatch:x,isPatched:i.has("mod-3"),speed:2.5}),e.jsx(y,{id:"mod-4",position:[-3.5,-1.2,1],geometry:m,onPatch:x,isPatched:i.has("mod-4"),speed:3.5}),e.jsx(D,{count:o?100:50,scale:10,size:o?3:5,speed:o?.3:.8,opacity:.8,color:o?"#06b6d4":"#ef4444"})]})};export{ie as default};
