const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/BootScene-KBaouhkE.js","assets/three-Cwdqg_u8.js","assets/vendor-CqO7gtIP.js","assets/animation-B64uUSMy.js","assets/HubScene-CFlpwmMI.js","assets/ProfileScene-C0sxOa8H.js","assets/Lab01Scene-B_xSJRnH.js","assets/Lab02Scene-3cIUYUg3.js","assets/Lab03Scene-CEvcj-1X.js","assets/Lab04Scene-Cq8ltwvF.js","assets/ContactScene-CbL8WFCh.js"])))=>i.map(i=>d[i]);
import{r as h,R as O,V as w,U as K,S as E,D as Mt,a as At,b as Rt,c as _t,W as D,L as ue,M as Ct,C as ee,N as te,F as Nt,B as re,E as Ce,d as it,e as nt,f as m,g as je,O as Pt,h as It,i as oe,k as ae,l as G,m as Ut,n as W,o as at,T as ot,p as Ne,P as Bt,A as Ot,q as Dt,s as ze,t as Lt,u as He,v as de,w as kt,H as jt,x as Pe,y as zt,z as Ht,j as a,G as Ft,I as Gt,_ as $,J as Vt,K as Wt,Q as $t,X,Y as qt,Z as Xt,$ as Kt,a0 as Yt}from"./three-Cwdqg_u8.js";import{g as Ie}from"./vendor-CqO7gtIP.js";import{g as we,A as Zt,m as M}from"./animation-B64uUSMy.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const i of n.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function r(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerPolicy&&(n.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?n.credentials="include":o.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(o){if(o.ep)return;o.ep=!0;const n=r(o);fetch(o.href,n)}})();var me,Fe;function Qt(){if(Fe)return me;Fe=1;var e=typeof Element<"u",t=typeof Map=="function",r=typeof Set=="function",s=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function o(n,i){if(n===i)return!0;if(n&&i&&typeof n=="object"&&typeof i=="object"){if(n.constructor!==i.constructor)return!1;var l,c,u;if(Array.isArray(n)){if(l=n.length,l!=i.length)return!1;for(c=l;c--!==0;)if(!o(n[c],i[c]))return!1;return!0}var d;if(t&&n instanceof Map&&i instanceof Map){if(n.size!==i.size)return!1;for(d=n.entries();!(c=d.next()).done;)if(!i.has(c.value[0]))return!1;for(d=n.entries();!(c=d.next()).done;)if(!o(c.value[1],i.get(c.value[0])))return!1;return!0}if(r&&n instanceof Set&&i instanceof Set){if(n.size!==i.size)return!1;for(d=n.entries();!(c=d.next()).done;)if(!i.has(c.value[0]))return!1;return!0}if(s&&ArrayBuffer.isView(n)&&ArrayBuffer.isView(i)){if(l=n.length,l!=i.length)return!1;for(c=l;c--!==0;)if(n[c]!==i[c])return!1;return!0}if(n.constructor===RegExp)return n.source===i.source&&n.flags===i.flags;if(n.valueOf!==Object.prototype.valueOf&&typeof n.valueOf=="function"&&typeof i.valueOf=="function")return n.valueOf()===i.valueOf();if(n.toString!==Object.prototype.toString&&typeof n.toString=="function"&&typeof i.toString=="function")return n.toString()===i.toString();if(u=Object.keys(n),l=u.length,l!==Object.keys(i).length)return!1;for(c=l;c--!==0;)if(!Object.prototype.hasOwnProperty.call(i,u[c]))return!1;if(e&&n instanceof Element)return!1;for(c=l;c--!==0;)if(!((u[c]==="_owner"||u[c]==="__v"||u[c]==="__o")&&n.$$typeof)&&!o(n[u[c]],i[u[c]]))return!1;return!0}return n!==n&&i!==i}return me=function(i,l){try{return o(i,l)}catch(c){if((c.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw c}},me}var Jt=Qt();const er=Ie(Jt);var ve,Ge;function tr(){if(Ge)return ve;Ge=1;var e=function(t,r,s,o,n,i,l,c){if(!t){var u;if(r===void 0)u=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var d=[s,o,n,i,l,c],f=0;u=new Error(r.replace(/%s/g,function(){return d[f++]})),u.name="Invariant Violation"}throw u.framesToPop=1,u}};return ve=e,ve}var rr=tr();const Ve=Ie(rr);var ge,We;function sr(){return We||(We=1,ge=function(t,r,s,o){var n=s?s.call(o,t,r):void 0;if(n!==void 0)return!!n;if(t===r)return!0;if(typeof t!="object"||!t||typeof r!="object"||!r)return!1;var i=Object.keys(t),l=Object.keys(r);if(i.length!==l.length)return!1;for(var c=Object.prototype.hasOwnProperty.bind(r),u=0;u<i.length;u++){var d=i[u];if(!c(d))return!1;var f=t[d],v=r[d];if(n=s?s.call(o,f,v,d):void 0,n===!1||n===void 0&&f!==v)return!1}return!0}),ge}var ir=sr();const nr=Ie(ir);var lt=(e=>(e.BASE="base",e.BODY="body",e.HEAD="head",e.HTML="html",e.LINK="link",e.META="meta",e.NOSCRIPT="noscript",e.SCRIPT="script",e.STYLE="style",e.TITLE="title",e.FRAGMENT="Symbol(react.fragment)",e))(lt||{}),xe={link:{rel:["amphtml","canonical","alternate"]},script:{type:["application/ld+json"]},meta:{charset:"",name:["generator","robots","description"],property:["og:type","og:title","og:url","og:image","og:image:alt","og:description","twitter:url","twitter:title","twitter:description","twitter:image","twitter:image:alt","twitter:card","twitter:site"]}},$e=Object.values(lt),Ue={accesskey:"accessKey",charset:"charSet",class:"className",contenteditable:"contentEditable",contextmenu:"contextMenu","http-equiv":"httpEquiv",itemprop:"itemProp",tabindex:"tabIndex"},ar=Object.entries(Ue).reduce((e,[t,r])=>(e[r]=t,e),{}),j="data-rh",Q={DEFAULT_TITLE:"defaultTitle",DEFER:"defer",ENCODE_SPECIAL_CHARACTERS:"encodeSpecialCharacters",ON_CHANGE_CLIENT_STATE:"onChangeClientState",TITLE_TEMPLATE:"titleTemplate",PRIORITIZE_SEO_TAGS:"prioritizeSeoTags"},J=(e,t)=>{for(let r=e.length-1;r>=0;r-=1){const s=e[r];if(Object.prototype.hasOwnProperty.call(s,t))return s[t]}return null},or=e=>{let t=J(e,"title");const r=J(e,Q.TITLE_TEMPLATE);if(Array.isArray(t)&&(t=t.join("")),r&&t)return r.replace(/%s/g,()=>t);const s=J(e,Q.DEFAULT_TITLE);return t||s||void 0},lr=e=>J(e,Q.ON_CHANGE_CLIENT_STATE)||(()=>{}),ye=(e,t)=>t.filter(r=>typeof r[e]<"u").map(r=>r[e]).reduce((r,s)=>({...r,...s}),{}),cr=(e,t)=>t.filter(r=>typeof r.base<"u").map(r=>r.base).reverse().reduce((r,s)=>{if(!r.length){const o=Object.keys(s);for(let n=0;n<o.length;n+=1){const l=o[n].toLowerCase();if(e.indexOf(l)!==-1&&s[l])return r.concat(s)}}return r},[]),ur=e=>console&&typeof console.warn=="function"&&console.warn(e),se=(e,t,r)=>{const s={};return r.filter(o=>Array.isArray(o[e])?!0:(typeof o[e]<"u"&&ur(`Helmet: ${e} should be of type "Array". Instead found type "${typeof o[e]}"`),!1)).map(o=>o[e]).reverse().reduce((o,n)=>{const i={};n.filter(c=>{let u;const d=Object.keys(c);for(let v=0;v<d.length;v+=1){const p=d[v],S=p.toLowerCase();t.indexOf(S)!==-1&&!(u==="rel"&&c[u].toLowerCase()==="canonical")&&!(S==="rel"&&c[S].toLowerCase()==="stylesheet")&&(u=S),t.indexOf(p)!==-1&&(p==="innerHTML"||p==="cssText"||p==="itemprop")&&(u=p)}if(!u||!c[u])return!1;const f=c[u].toLowerCase();return s[u]||(s[u]={}),i[u]||(i[u]={}),s[u][f]?!1:(i[u][f]=!0,!0)}).reverse().forEach(c=>o.push(c));const l=Object.keys(i);for(let c=0;c<l.length;c+=1){const u=l[c],d={...s[u],...i[u]};s[u]=d}return o},[]).reverse()},dr=(e,t)=>{if(Array.isArray(e)&&e.length){for(let r=0;r<e.length;r+=1)if(e[r][t])return!0}return!1},hr=e=>({baseTag:cr(["href"],e),bodyAttributes:ye("bodyAttributes",e),defer:J(e,Q.DEFER),encode:J(e,Q.ENCODE_SPECIAL_CHARACTERS),htmlAttributes:ye("htmlAttributes",e),linkTags:se("link",["rel","href"],e),metaTags:se("meta",["name","charset","http-equiv","property","itemprop"],e),noscriptTags:se("noscript",["innerHTML"],e),onChangeClientState:lr(e),scriptTags:se("script",["src","innerHTML"],e),styleTags:se("style",["cssText"],e),title:or(e),titleAttributes:ye("titleAttributes",e),prioritizeSeoTags:dr(e,Q.PRIORITIZE_SEO_TAGS)}),ct=e=>Array.isArray(e)?e.join(""):e,fr=(e,t)=>{const r=Object.keys(e);for(let s=0;s<r.length;s+=1)if(t[r[s]]&&t[r[s]].includes(e[r[s]]))return!0;return!1},be=(e,t)=>Array.isArray(e)?e.reduce((r,s)=>(fr(s,t)?r.priority.push(s):r.default.push(s),r),{priority:[],default:[]}):{default:e,priority:[]},qe=(e,t)=>({...e,[t]:void 0}),pr=["noscript","script","style"],Ee=(e,t=!0)=>t===!1?String(e):String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;"),ut=e=>Object.keys(e).reduce((t,r)=>{const s=typeof e[r]<"u"?`${r}="${e[r]}"`:`${r}`;return t?`${t} ${s}`:s},""),mr=(e,t,r,s)=>{const o=ut(r),n=ct(t);return o?`<${e} ${j}="true" ${o}>${Ee(n,s)}</${e}>`:`<${e} ${j}="true">${Ee(n,s)}</${e}>`},vr=(e,t,r=!0)=>t.reduce((s,o)=>{const n=o,i=Object.keys(n).filter(u=>!(u==="innerHTML"||u==="cssText")).reduce((u,d)=>{const f=typeof n[d]>"u"?d:`${d}="${Ee(n[d],r)}"`;return u?`${u} ${f}`:f},""),l=n.innerHTML||n.cssText||"",c=pr.indexOf(e)===-1;return`${s}<${e} ${j}="true" ${i}${c?"/>":`>${l}</${e}>`}`},""),dt=(e,t={})=>Object.keys(e).reduce((r,s)=>{const o=Ue[s];return r[o||s]=e[s],r},t),gr=(e,t,r)=>{const s={key:t,[j]:!0},o=dt(r,s);return[O.createElement("title",o,t)]},ce=(e,t)=>t.map((r,s)=>{const o={key:s,[j]:!0};return Object.keys(r).forEach(n=>{const l=Ue[n]||n;if(l==="innerHTML"||l==="cssText"){const c=r.innerHTML||r.cssText;o.dangerouslySetInnerHTML={__html:c}}else o[l]=r[n]}),O.createElement(e,o)}),B=(e,t,r=!0)=>{switch(e){case"title":return{toComponent:()=>gr(e,t.title,t.titleAttributes),toString:()=>mr(e,t.title,t.titleAttributes,r)};case"bodyAttributes":case"htmlAttributes":return{toComponent:()=>dt(t),toString:()=>ut(t)};default:return{toComponent:()=>ce(e,t),toString:()=>vr(e,t,r)}}},xr=({metaTags:e,linkTags:t,scriptTags:r,encode:s})=>{const o=be(e,xe.meta),n=be(t,xe.link),i=be(r,xe.script);return{priorityMethods:{toComponent:()=>[...ce("meta",o.priority),...ce("link",n.priority),...ce("script",i.priority)],toString:()=>`${B("meta",o.priority,s)} ${B("link",n.priority,s)} ${B("script",i.priority,s)}`},metaTags:o.default,linkTags:n.default,scriptTags:i.default}},yr=e=>{const{baseTag:t,bodyAttributes:r,encode:s=!0,htmlAttributes:o,noscriptTags:n,styleTags:i,title:l="",titleAttributes:c,prioritizeSeoTags:u}=e;let{linkTags:d,metaTags:f,scriptTags:v}=e,p={toComponent:()=>{},toString:()=>""};return u&&({priorityMethods:p,linkTags:d,metaTags:f,scriptTags:v}=xr(e)),{priority:p,base:B("base",t,s),bodyAttributes:B("bodyAttributes",r,s),htmlAttributes:B("htmlAttributes",o,s),link:B("link",d,s),meta:B("meta",f,s),noscript:B("noscript",n,s),script:B("script",v,s),style:B("style",i,s),title:B("title",{title:l,titleAttributes:c},s)}},Me=yr,le=[],ht=!!(typeof window<"u"&&window.document&&window.document.createElement),Ae=class{instances=[];canUseDOM=ht;context;value={setHelmet:e=>{this.context.helmet=e},helmetInstances:{get:()=>this.canUseDOM?le:this.instances,add:e=>{(this.canUseDOM?le:this.instances).push(e)},remove:e=>{const t=(this.canUseDOM?le:this.instances).indexOf(e);(this.canUseDOM?le:this.instances).splice(t,1)}}};constructor(e,t){this.context=e,this.canUseDOM=t||!1,t||(e.helmet=Me({baseTag:[],bodyAttributes:{},htmlAttributes:{},linkTags:[],metaTags:[],noscriptTags:[],scriptTags:[],styleTags:[],title:"",titleAttributes:{}}))}},br={},ft=O.createContext(br),pt=class mt extends h.Component{static canUseDOM=ht;helmetData;constructor(t){super(t),this.helmetData=new Ae(this.props.context||{},mt.canUseDOM)}render(){return O.createElement(ft.Provider,{value:this.helmetData.value},this.props.children)}},Z=(e,t)=>{const r=document.head||document.querySelector("head"),s=r.querySelectorAll(`${e}[${j}]`),o=[].slice.call(s),n=[];let i;return t&&t.length&&t.forEach(l=>{const c=document.createElement(e);for(const u in l)if(Object.prototype.hasOwnProperty.call(l,u))if(u==="innerHTML")c.innerHTML=l.innerHTML;else if(u==="cssText")c.styleSheet?c.styleSheet.cssText=l.cssText:c.appendChild(document.createTextNode(l.cssText));else{const d=u,f=typeof l[d]>"u"?"":l[d];c.setAttribute(u,f)}c.setAttribute(j,"true"),o.some((u,d)=>(i=d,c.isEqualNode(u)))?o.splice(i,1):n.push(c)}),o.forEach(l=>l.parentNode?.removeChild(l)),n.forEach(l=>r.appendChild(l)),{oldTags:o,newTags:n}},Re=(e,t)=>{const r=document.getElementsByTagName(e)[0];if(!r)return;const s=r.getAttribute(j),o=s?s.split(","):[],n=[...o],i=Object.keys(t);for(const l of i){const c=t[l]||"";r.getAttribute(l)!==c&&r.setAttribute(l,c),o.indexOf(l)===-1&&o.push(l);const u=n.indexOf(l);u!==-1&&n.splice(u,1)}for(let l=n.length-1;l>=0;l-=1)r.removeAttribute(n[l]);o.length===n.length?r.removeAttribute(j):r.getAttribute(j)!==i.join(",")&&r.setAttribute(j,i.join(","))},Tr=(e,t)=>{typeof e<"u"&&document.title!==e&&(document.title=ct(e)),Re("title",t)},Xe=(e,t)=>{const{baseTag:r,bodyAttributes:s,htmlAttributes:o,linkTags:n,metaTags:i,noscriptTags:l,onChangeClientState:c,scriptTags:u,styleTags:d,title:f,titleAttributes:v}=e;Re("body",s),Re("html",o),Tr(f,v);const p={baseTag:Z("base",r),linkTags:Z("link",n),metaTags:Z("meta",i),noscriptTags:Z("noscript",l),scriptTags:Z("script",u),styleTags:Z("style",d)},S={},R={};Object.keys(p).forEach(I=>{const{newTags:N,oldTags:T}=p[I];N.length&&(S[I]=N),T.length&&(R[I]=p[I].oldTags)}),t&&t(),c(e,S,R)},ie=null,Sr=e=>{ie&&cancelAnimationFrame(ie),e.defer?ie=requestAnimationFrame(()=>{Xe(e,()=>{ie=null})}):(Xe(e),ie=null)},wr=Sr,Ke=class extends h.Component{rendered=!1;shouldComponentUpdate(e){return!nr(e,this.props)}componentDidUpdate(){this.emitChange()}componentWillUnmount(){const{helmetInstances:e}=this.props.context;e.remove(this),this.emitChange()}emitChange(){const{helmetInstances:e,setHelmet:t}=this.props.context;let r=null;const s=hr(e.get().map(o=>{const n={...o.props};return delete n.context,n}));pt.canUseDOM?wr(s):Me&&(r=Me(s)),t(r)}init(){if(this.rendered)return;this.rendered=!0;const{helmetInstances:e}=this.props.context;e.add(this),this.emitChange()}render(){return this.init(),null}},Er=class extends h.Component{static defaultProps={defer:!0,encodeSpecialCharacters:!0,prioritizeSeoTags:!1};shouldComponentUpdate(e){return!er(qe(this.props,"helmetData"),qe(e,"helmetData"))}mapNestedChildrenToProps(e,t){if(!t)return null;switch(e.type){case"script":case"noscript":return{innerHTML:t};case"style":return{cssText:t};default:throw new Error(`<${e.type} /> elements are self-closing and can not contain children. Refer to our API for more information.`)}}flattenArrayTypeChildren(e,t,r,s){return{...t,[e.type]:[...t[e.type]||[],{...r,...this.mapNestedChildrenToProps(e,s)}]}}mapObjectTypeChildren(e,t,r,s){switch(e.type){case"title":return{...t,[e.type]:s,titleAttributes:{...r}};case"body":return{...t,bodyAttributes:{...r}};case"html":return{...t,htmlAttributes:{...r}};default:return{...t,[e.type]:{...r}}}}mapArrayTypeChildrenToProps(e,t){let r={...t};return Object.keys(e).forEach(s=>{r={...r,[s]:e[s]}}),r}warnOnInvalidChildren(e,t){return Ve($e.some(r=>e.type===r),typeof e.type=="function"?"You may be attempting to nest <Helmet> components within each other, which is not allowed. Refer to our API for more information.":`Only elements types ${$e.join(", ")} are allowed. Helmet does not support rendering <${e.type}> elements. Refer to our API for more information.`),Ve(!t||typeof t=="string"||Array.isArray(t)&&!t.some(r=>typeof r!="string"),`Helmet expects a string as a child of <${e.type}>. Did you forget to wrap your children in braces? ( <${e.type}>{\`\`}</${e.type}> ) Refer to our API for more information.`),!0}mapChildrenToProps(e,t){let r={};return O.Children.forEach(e,s=>{if(!s||!s.props)return;const{children:o,...n}=s.props,i=Object.keys(n).reduce((c,u)=>(c[ar[u]||u]=n[u],c),{});let{type:l}=s;switch(typeof l=="symbol"?l=l.toString():this.warnOnInvalidChildren(s,o),l){case"Symbol(react.fragment)":t=this.mapChildrenToProps(o,t);break;case"link":case"meta":case"noscript":case"script":case"style":r=this.flattenArrayTypeChildren(s,r,i,o);break;default:t=this.mapObjectTypeChildren(s,t,i,o);break}}),this.mapArrayTypeChildrenToProps(r,t)}render(){const{children:e,...t}=this.props;let r={...t},{helmetData:s}=t;if(e&&(r=this.mapChildrenToProps(e,r)),s&&!(s instanceof Ae)){const o=s;s=new Ae(o.context,!0),delete r.helmetData}return s?O.createElement(Ke,{...r,context:s.value}):O.createElement(ft.Consumer,null,o=>O.createElement(Ke,{...r,context:o}))}};var Te=1/1e3,Mr=1e3,Ar=class{constructor(){this.startTime=performance.now(),this.previousTime=0,this.currentTime=0,this._delta=0,this._elapsed=0,this._fixedDelta=1e3/60,this.timescale=1,this.useFixedDelta=!1,this._autoReset=!1}get autoReset(){return this._autoReset}set autoReset(e){typeof document<"u"&&document.hidden!==void 0&&(e?document.addEventListener("visibilitychange",this):document.removeEventListener("visibilitychange",this),this._autoReset=e)}get delta(){return this._delta*Te}get fixedDelta(){return this._fixedDelta*Te}set fixedDelta(e){this._fixedDelta=e*Mr}get elapsed(){return this._elapsed*Te}update(e){this.useFixedDelta?this._delta=this.fixedDelta:(this.previousTime=this.currentTime,this.currentTime=(e!==void 0?e:performance.now())-this.startTime,this._delta=this.currentTime-this.previousTime),this._delta*=this.timescale,this._elapsed+=this._delta}reset(){this._delta=0,this._elapsed=0,this.currentTime=performance.now()-this.startTime}getDelta(){return this.delta}getElapsed(){return this.elapsed}handleEvent(e){document.hidden||(this.currentTime=performance.now()-this.startTime)}dispose(){this.autoReset=!1}},Rr=(()=>{const e=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),t=new Float32Array([0,0,2,0,0,2]),r=new Dt;return r.setAttribute("position",new ze(e,3)),r.setAttribute("uv",new ze(t,2)),r})(),_=class _e{static get fullscreenGeometry(){return Rr}constructor(t="Pass",r=new je,s=new Pt){this.name=t,this.renderer=null,this.scene=r,this.camera=s,this.screen=null,this.rtt=!0,this.needsSwap=!0,this.needsDepthTexture=!1,this.enabled=!0}get renderToScreen(){return!this.rtt}set renderToScreen(t){if(this.rtt===t){const r=this.fullscreenMaterial;r!==null&&(r.needsUpdate=!0),this.rtt=!t}}set mainScene(t){}set mainCamera(t){}setRenderer(t){this.renderer=t}isEnabled(){return this.enabled}setEnabled(t){this.enabled=t}get fullscreenMaterial(){return this.screen!==null?this.screen.material:null}set fullscreenMaterial(t){let r=this.screen;r!==null?r.material=t:(r=new It(_e.fullscreenGeometry,t),r.frustumCulled=!1,this.scene===null&&(this.scene=new je),this.scene.add(r),this.screen=r)}getFullscreenMaterial(){return this.fullscreenMaterial}setFullscreenMaterial(t){this.fullscreenMaterial=t}getDepthTexture(){return null}setDepthTexture(t,r=re){}render(t,r,s,o,n){throw new Error("Render method not implemented!")}setSize(t,r){}initialize(t,r,s){}dispose(){for(const t of Object.keys(this)){const r=this[t];(r instanceof D||r instanceof at||r instanceof ot||r instanceof _e)&&this[t].dispose()}this.fullscreenMaterial!==null&&this.fullscreenMaterial.dispose()}},_r=class extends _{constructor(){super("ClearMaskPass",null,null),this.needsSwap=!1}render(e,t,r,s,o){const n=e.state.buffers.stencil;n.setLocked(!1),n.setTest(!1)}},Cr=`#ifdef COLOR_WRITE
#include <common>
#include <dithering_pars_fragment>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#endif
#ifdef DEPTH_WRITE
#include <packing>
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}
#endif
#ifdef USE_WEIGHTS
uniform vec4 channelWeights;
#endif
uniform float opacity;varying vec2 vUv;void main(){
#ifdef COLOR_WRITE
vec4 texel=texture2D(inputBuffer,vUv);
#ifdef USE_WEIGHTS
texel*=channelWeights;
#endif
gl_FragColor=opacity*texel;
#ifdef COLOR_SPACE_CONVERSION
#include <colorspace_fragment>
#endif
#include <dithering_fragment>
#else
gl_FragColor=vec4(0.0);
#endif
#ifdef DEPTH_WRITE
gl_FragDepth=readDepth(vUv);
#endif
}`,Be="varying vec2 vUv;void main(){vUv=position.xy*0.5+0.5;gl_Position=vec4(position.xy,1.0,1.0);}",vt=class extends G{constructor(){super({name:"CopyMaterial",defines:{DEPTH_PACKING:"0",COLOR_WRITE:"1"},uniforms:{inputBuffer:new m(null),depthBuffer:new m(null),channelWeights:new m(null),opacity:new m(1)},blending:W,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:Cr,vertexShader:Be}),this.depthFunc=Ot}get inputBuffer(){return this.uniforms.inputBuffer.value}set inputBuffer(e){const t=e!==null;this.colorWrite!==t&&(t?this.defines.COLOR_WRITE=!0:delete this.defines.COLOR_WRITE,this.colorWrite=t,this.needsUpdate=!0),this.uniforms.inputBuffer.value=e}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(e){const t=e!==null;this.depthWrite!==t&&(t?this.defines.DEPTH_WRITE=!0:delete this.defines.DEPTH_WRITE,this.depthTest=t,this.depthWrite=t,this.needsUpdate=!0),this.uniforms.depthBuffer.value=e}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}get channelWeights(){return this.uniforms.channelWeights.value}set channelWeights(e){e!==null?(this.defines.USE_WEIGHTS="1",this.uniforms.channelWeights.value=e):delete this.defines.USE_WEIGHTS,this.needsUpdate=!0}setInputBuffer(e){this.uniforms.inputBuffer.value=e}getOpacity(e){return this.uniforms.opacity.value}setOpacity(e){this.uniforms.opacity.value=e}},gt=class extends _{constructor(e,t=!0){super("CopyPass"),this.fullscreenMaterial=new vt,this.needsSwap=!1,this.renderTarget=e,e===void 0&&(this.renderTarget=new D(1,1,{minFilter:ue,magFilter:ue,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="CopyPass.Target"),this.autoResize=t}get resize(){return this.autoResize}set resize(e){this.autoResize=e}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}setAutoResizeEnabled(e){this.autoResize=e}render(e,t,r,s,o){this.fullscreenMaterial.inputBuffer=t.texture,e.setRenderTarget(this.renderToScreen?null:this.renderTarget),e.render(this.scene,this.camera)}setSize(e,t){this.autoResize&&this.renderTarget.setSize(e,t)}initialize(e,t,r){r!==void 0&&(this.renderTarget.texture.type=r,r!==K?this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1":e!==null&&e.outputColorSpace===E&&(this.renderTarget.texture.colorSpace=E))}},Ye=new ee,xt=class extends _{constructor(e=!0,t=!0,r=!1){super("ClearPass",null,null),this.needsSwap=!1,this.color=e,this.depth=t,this.stencil=r,this.overrideClearColor=null,this.overrideClearAlpha=-1}setClearFlags(e,t,r){this.color=e,this.depth=t,this.stencil=r}getOverrideClearColor(){return this.overrideClearColor}setOverrideClearColor(e){this.overrideClearColor=e}getOverrideClearAlpha(){return this.overrideClearAlpha}setOverrideClearAlpha(e){this.overrideClearAlpha=e}render(e,t,r,s,o){const n=this.overrideClearColor,i=this.overrideClearAlpha,l=e.getClearAlpha(),c=n!==null,u=i>=0;c?(e.getClearColor(Ye),e.setClearColor(n,u?i:l)):u&&e.setClearAlpha(i),e.setRenderTarget(this.renderToScreen?null:t),e.clear(this.color,this.depth,this.stencil),c?e.setClearColor(Ye,l):u&&e.setClearAlpha(l)}},Nr=class extends _{constructor(e,t){super("MaskPass",e,t),this.needsSwap=!1,this.clearPass=new xt(!1,!1,!0),this.inverse=!1}set mainScene(e){this.scene=e}set mainCamera(e){this.camera=e}get inverted(){return this.inverse}set inverted(e){this.inverse=e}get clear(){return this.clearPass.enabled}set clear(e){this.clearPass.enabled=e}getClearPass(){return this.clearPass}isInverted(){return this.inverted}setInverted(e){this.inverted=e}render(e,t,r,s,o){const n=e.getContext(),i=e.state.buffers,l=this.scene,c=this.camera,u=this.clearPass,d=this.inverted?0:1,f=1-d;i.color.setMask(!1),i.depth.setMask(!1),i.color.setLocked(!0),i.depth.setLocked(!0),i.stencil.setTest(!0),i.stencil.setOp(n.REPLACE,n.REPLACE,n.REPLACE),i.stencil.setFunc(n.ALWAYS,d,4294967295),i.stencil.setClear(f),i.stencil.setLocked(!0),this.clearPass.enabled&&(this.renderToScreen?u.render(e,null):(u.render(e,t),u.render(e,r))),this.renderToScreen?(e.setRenderTarget(null),e.render(l,c)):(e.setRenderTarget(t),e.render(l,c),e.setRenderTarget(r),e.render(l,c)),i.color.setLocked(!1),i.depth.setLocked(!1),i.stencil.setLocked(!1),i.stencil.setFunc(n.EQUAL,1,4294967295),i.stencil.setOp(n.KEEP,n.KEEP,n.KEEP),i.stencil.setLocked(!0)}},Pr=class{constructor(t=null,{depthBuffer:r=!0,stencilBuffer:s=!1,multisampling:o=0,frameBufferType:n}={}){this.renderer=null,this.inputBuffer=this.createBuffer(r,s,n,o),this.outputBuffer=this.inputBuffer.clone(),this.copyPass=new gt,this.depthTexture=null,this.passes=[],this.timer=new Ar,this.autoRenderToScreen=!0,this.setRenderer(t)}get multisampling(){return this.inputBuffer.samples||0}set multisampling(t){const r=this.inputBuffer,s=this.multisampling;s>0&&t>0?(this.inputBuffer.samples=t,this.outputBuffer.samples=t,this.inputBuffer.dispose(),this.outputBuffer.dispose()):s!==t&&(this.inputBuffer.dispose(),this.outputBuffer.dispose(),this.inputBuffer=this.createBuffer(r.depthBuffer,r.stencilBuffer,r.texture.type,t),this.inputBuffer.depthTexture=this.depthTexture,this.outputBuffer=this.inputBuffer.clone())}getTimer(){return this.timer}getRenderer(){return this.renderer}setRenderer(t){if(this.renderer=t,t!==null){const r=t.getSize(new w),s=t.getContext().getContextAttributes().alpha,o=this.inputBuffer.texture.type;o===K&&t.outputColorSpace===E&&(this.inputBuffer.texture.colorSpace=E,this.outputBuffer.texture.colorSpace=E,this.inputBuffer.dispose(),this.outputBuffer.dispose()),t.autoClear=!1,this.setSize(r.width,r.height);for(const n of this.passes)n.initialize(t,s,o)}}replaceRenderer(t,r=!0){const s=this.renderer,o=s.domElement.parentNode;return this.setRenderer(t),r&&o!==null&&(o.removeChild(s.domElement),o.appendChild(t.domElement)),s}createDepthTexture(){const t=this.depthTexture=new Mt;return this.inputBuffer.depthTexture=t,this.inputBuffer.dispose(),this.inputBuffer.stencilBuffer?(t.format=At,t.type=Rt):t.type=_t,t}deleteDepthTexture(){if(this.depthTexture!==null){this.depthTexture.dispose(),this.depthTexture=null,this.inputBuffer.depthTexture=null,this.inputBuffer.dispose();for(const t of this.passes)t.setDepthTexture(null)}}createBuffer(t,r,s,o){const n=this.renderer,i=n===null?new w:n.getDrawingBufferSize(new w),l={minFilter:ue,magFilter:ue,stencilBuffer:r,depthBuffer:t,type:s},c=new D(i.width,i.height,l);return o>0&&(c.samples=o),s===K&&n!==null&&n.outputColorSpace===E&&(c.texture.colorSpace=E),c.texture.name="EffectComposer.Buffer",c.texture.generateMipmaps=!1,c}setMainScene(t){for(const r of this.passes)r.mainScene=t}setMainCamera(t){for(const r of this.passes)r.mainCamera=t}addPass(t,r){const s=this.passes,o=this.renderer,n=o.getDrawingBufferSize(new w),i=o.getContext().getContextAttributes().alpha,l=this.inputBuffer.texture.type;if(t.setRenderer(o),t.setSize(n.width,n.height),t.initialize(o,i,l),this.autoRenderToScreen&&(s.length>0&&(s[s.length-1].renderToScreen=!1),t.renderToScreen&&(this.autoRenderToScreen=!1)),r!==void 0?s.splice(r,0,t):s.push(t),this.autoRenderToScreen&&(s[s.length-1].renderToScreen=!0),t.needsDepthTexture||this.depthTexture!==null)if(this.depthTexture===null){const c=this.createDepthTexture();for(t of s)t.setDepthTexture(c)}else t.setDepthTexture(this.depthTexture)}removePass(t){const r=this.passes,s=r.indexOf(t);if(s!==-1&&r.splice(s,1).length>0){if(this.depthTexture!==null){const i=(c,u)=>c||u.needsDepthTexture;r.reduce(i,!1)||(t.getDepthTexture()===this.depthTexture&&t.setDepthTexture(null),this.deleteDepthTexture())}this.autoRenderToScreen&&s===r.length&&(t.renderToScreen=!1,r.length>0&&(r[r.length-1].renderToScreen=!0))}}removeAllPasses(){const t=this.passes;this.deleteDepthTexture(),t.length>0&&(this.autoRenderToScreen&&(t[t.length-1].renderToScreen=!1),this.passes=[])}render(t){const r=this.renderer,s=this.copyPass;let o=this.inputBuffer,n=this.outputBuffer,i=!1,l,c,u;t===void 0&&(this.timer.update(),t=this.timer.getDelta());for(const d of this.passes)d.enabled&&(d.render(r,o,n,t,i),d.needsSwap&&(i&&(s.renderToScreen=d.renderToScreen,l=r.getContext(),c=r.state.buffers.stencil,c.setFunc(l.NOTEQUAL,1,4294967295),s.render(r,o,n,t,i),c.setFunc(l.EQUAL,1,4294967295)),u=o,o=n,n=u),d instanceof Nr?i=!0:d instanceof _r&&(i=!1))}setSize(t,r,s){const o=this.renderer,n=o.getSize(new w);(t===void 0||r===void 0)&&(t=n.width,r=n.height),(n.width!==t||n.height!==r)&&o.setSize(t,r,s);const i=o.getDrawingBufferSize(new w);this.inputBuffer.setSize(i.width,i.height),this.outputBuffer.setSize(i.width,i.height);for(const l of this.passes)l.setSize(i.width,i.height)}reset(){this.dispose(),this.autoRenderToScreen=!0}dispose(){for(const t of this.passes)t.dispose();this.passes=[],this.inputBuffer!==null&&this.inputBuffer.dispose(),this.outputBuffer!==null&&this.outputBuffer.dispose(),this.deleteDepthTexture(),this.copyPass.dispose(),this.timer.dispose(),_.fullscreenGeometry.dispose()}},z={NONE:0,DEPTH:1,CONVOLUTION:2},x={FRAGMENT_HEAD:"FRAGMENT_HEAD",FRAGMENT_MAIN_UV:"FRAGMENT_MAIN_UV",FRAGMENT_MAIN_IMAGE:"FRAGMENT_MAIN_IMAGE",VERTEX_HEAD:"VERTEX_HEAD",VERTEX_MAIN_SUPPORT:"VERTEX_MAIN_SUPPORT"},Ir=class{constructor(){this.shaderParts=new Map([[x.FRAGMENT_HEAD,null],[x.FRAGMENT_MAIN_UV,null],[x.FRAGMENT_MAIN_IMAGE,null],[x.VERTEX_HEAD,null],[x.VERTEX_MAIN_SUPPORT,null]]),this.defines=new Map,this.uniforms=new Map,this.blendModes=new Map,this.extensions=new Set,this.attributes=z.NONE,this.varyings=new Set,this.uvTransformation=!1,this.readDepth=!1,this.colorSpace=it}},Se=!1,Ze=class{constructor(e=null){this.originalMaterials=new Map,this.material=null,this.materials=null,this.materialsBackSide=null,this.materialsDoubleSide=null,this.materialsFlatShaded=null,this.materialsFlatShadedBackSide=null,this.materialsFlatShadedDoubleSide=null,this.setMaterial(e),this.meshCount=0,this.replaceMaterial=t=>{if(t.isMesh){let r;if(t.material.flatShading)switch(t.material.side){case ae:r=this.materialsFlatShadedDoubleSide;break;case oe:r=this.materialsFlatShadedBackSide;break;default:r=this.materialsFlatShaded;break}else switch(t.material.side){case ae:r=this.materialsDoubleSide;break;case oe:r=this.materialsBackSide;break;default:r=this.materials;break}this.originalMaterials.set(t,t.material),t.isSkinnedMesh?t.material=r[2]:t.isInstancedMesh?t.material=r[1]:t.material=r[0],++this.meshCount}}}cloneMaterial(e){if(!(e instanceof G))return e.clone();const t=e.uniforms,r=new Map;for(const o in t){const n=t[o].value;n.isRenderTargetTexture&&(t[o].value=null,r.set(o,n))}const s=e.clone();for(const o of r)t[o[0]].value=o[1],s.uniforms[o[0]].value=o[1];return s}setMaterial(e){if(this.disposeMaterials(),this.material=e,e!==null){const t=this.materials=[this.cloneMaterial(e),this.cloneMaterial(e),this.cloneMaterial(e)];for(const r of t)r.uniforms=Object.assign({},e.uniforms),r.side=Ut;t[2].skinning=!0,this.materialsBackSide=t.map(r=>{const s=this.cloneMaterial(r);return s.uniforms=Object.assign({},e.uniforms),s.side=oe,s}),this.materialsDoubleSide=t.map(r=>{const s=this.cloneMaterial(r);return s.uniforms=Object.assign({},e.uniforms),s.side=ae,s}),this.materialsFlatShaded=t.map(r=>{const s=this.cloneMaterial(r);return s.uniforms=Object.assign({},e.uniforms),s.flatShading=!0,s}),this.materialsFlatShadedBackSide=t.map(r=>{const s=this.cloneMaterial(r);return s.uniforms=Object.assign({},e.uniforms),s.flatShading=!0,s.side=oe,s}),this.materialsFlatShadedDoubleSide=t.map(r=>{const s=this.cloneMaterial(r);return s.uniforms=Object.assign({},e.uniforms),s.flatShading=!0,s.side=ae,s})}}render(e,t,r){const s=e.shadowMap.enabled;if(e.shadowMap.enabled=!1,Se){const o=this.originalMaterials;this.meshCount=0,t.traverse(this.replaceMaterial),e.render(t,r);for(const n of o)n[0].material=n[1];this.meshCount!==o.size&&o.clear()}else{const o=t.overrideMaterial;t.overrideMaterial=this.material,e.render(t,r),t.overrideMaterial=o}e.shadowMap.enabled=s}disposeMaterials(){if(this.material!==null){const e=this.materials.concat(this.materialsBackSide).concat(this.materialsDoubleSide).concat(this.materialsFlatShaded).concat(this.materialsFlatShadedBackSide).concat(this.materialsFlatShadedDoubleSide);for(const t of e)t.dispose()}}dispose(){this.originalMaterials.clear(),this.disposeMaterials()}static get workaroundEnabled(){return Se}static set workaroundEnabled(e){Se=e}},V=-1,A=class extends Ce{constructor(e,t=V,r=V,s=1){super(),this.resizable=e,this.baseSize=new w(1,1),this.preferredSize=new w(t,r),this.target=this.preferredSize,this.s=s,this.effectiveSize=new w,this.addEventListener("change",()=>this.updateEffectiveSize()),this.updateEffectiveSize()}updateEffectiveSize(){const e=this.baseSize,t=this.preferredSize,r=this.effectiveSize,s=this.scale;t.width!==V?r.width=t.width:t.height!==V?r.width=Math.round(t.height*(e.width/Math.max(e.height,1))):r.width=Math.round(e.width*s),t.height!==V?r.height=t.height:t.width!==V?r.height=Math.round(t.width/Math.max(e.width/Math.max(e.height,1),1)):r.height=Math.round(e.height*s)}get width(){return this.effectiveSize.width}set width(e){this.preferredWidth=e}get height(){return this.effectiveSize.height}set height(e){this.preferredHeight=e}getWidth(){return this.width}getHeight(){return this.height}get scale(){return this.s}set scale(e){this.s!==e&&(this.s=e,this.preferredSize.setScalar(V),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getScale(){return this.scale}setScale(e){this.scale=e}get baseWidth(){return this.baseSize.width}set baseWidth(e){this.baseSize.width!==e&&(this.baseSize.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseWidth(){return this.baseWidth}setBaseWidth(e){this.baseWidth=e}get baseHeight(){return this.baseSize.height}set baseHeight(e){this.baseSize.height!==e&&(this.baseSize.height=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseHeight(){return this.baseHeight}setBaseHeight(e){this.baseHeight=e}setBaseSize(e,t){(this.baseSize.width!==e||this.baseSize.height!==t)&&(this.baseSize.set(e,t),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}get preferredWidth(){return this.preferredSize.width}set preferredWidth(e){this.preferredSize.width!==e&&(this.preferredSize.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredWidth(){return this.preferredWidth}setPreferredWidth(e){this.preferredWidth=e}get preferredHeight(){return this.preferredSize.height}set preferredHeight(e){this.preferredSize.height!==e&&(this.preferredSize.height=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredHeight(){return this.preferredHeight}setPreferredHeight(e){this.preferredHeight=e}setPreferredSize(e,t){(this.preferredSize.width!==e||this.preferredSize.height!==t)&&(this.preferredSize.set(e,t),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}copy(e){this.s=e.scale,this.baseSize.set(e.baseWidth,e.baseHeight),this.preferredSize.set(e.preferredWidth,e.preferredHeight),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height)}static get AUTO_SIZE(){return V}},g={ADD:0,AVERAGE:2,COLOR:3,COLOR_BURN:4,COLOR_DODGE:5,DARKEN:6,DIFFERENCE:7,DIVIDE:8,DST:9,EXCLUSION:10,HARD_LIGHT:11,HARD_MIX:12,HUE:13,INVERT:14,INVERT_RGB:15,LIGHTEN:16,LINEAR_BURN:17,LINEAR_DODGE:18,LINEAR_LIGHT:19,LUMINOSITY:20,MULTIPLY:21,NEGATION:22,NORMAL:23,OVERLAY:24,PIN_LIGHT:25,REFLECT:26,SATURATION:27,SCREEN:28,SOFT_LIGHT:29,SRC:30,SUBTRACT:31,VIVID_LIGHT:32},Ur="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(x.rgb+y.rgb,y.a),y.a*opacity);}",Br="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4((x.rgb+y.rgb)*0.5,y.a),y.a*opacity);}",Or="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(yHSL.xy,xHSL.z));return mix(x,vec4(z,y.a),y.a*opacity);}",Dr="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 a=x.rgb,b=y.rgb;vec3 z=mix(step(0.0,b)*(1.0-min(vec3(1.0),(1.0-a)/b)),vec3(1.0),step(1.0,a));return mix(x,vec4(z,y.a),y.a*opacity);}",Lr="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 a=x.rgb,b=y.rgb;vec3 z=step(0.0,a)*mix(min(vec3(1.0),a/max(1.0-b,1e-9)),vec3(1.0),step(1.0,b));return mix(x,vec4(z,y.a),y.a*opacity);}",kr="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(min(x.rgb,y.rgb),y.a),y.a*opacity);}",jr="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(abs(x.rgb-y.rgb),y.a),y.a*opacity);}",zr="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(x.rgb/max(y.rgb,1e-12),y.a),y.a*opacity);}",Hr="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4((x.rgb+y.rgb-2.0*x.rgb*y.rgb),y.a),y.a*opacity);}",Fr="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 a=min(x.rgb,1.0);vec3 b=min(y.rgb,1.0);vec3 z=mix(2.0*a*b,1.0-2.0*(1.0-a)*(1.0-b),step(0.5,b));return mix(x,vec4(z,y.a),y.a*opacity);}",Gr="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(step(1.0,x.rgb+y.rgb),y.a),y.a*opacity);}",Vr="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(yHSL.x,xHSL.yz));return mix(x,vec4(z,y.a),y.a*opacity);}",Wr="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(1.0-y.rgb,y.a),y.a*opacity);}",$r="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(y.rgb*(1.0-x.rgb),y.a),y.a*opacity);}",qr="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(max(x.rgb,y.rgb),y.a),y.a*opacity);}",Xr="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(clamp(y.rgb+x.rgb-1.0,0.0,1.0),y.a),y.a*opacity);}",Kr="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(min(x.rgb+y.rgb,1.0),y.a),y.a*opacity);}",Yr="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(clamp(2.0*y.rgb+x.rgb-1.0,0.0,1.0),y.a),y.a*opacity);}",Zr="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(xHSL.xy,yHSL.z));return mix(x,vec4(z,y.a),y.a*opacity);}",Qr="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(x.rgb*y.rgb,y.a),y.a*opacity);}",Jr="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(1.0-abs(1.0-x.rgb-y.rgb),y.a),y.a*opacity);}",es="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,y,y.a*opacity);}",ts="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 z=mix(2.0*y.rgb*x.rgb,1.0-2.0*(1.0-y.rgb)*(1.0-x.rgb),step(0.5,x.rgb));return mix(x,vec4(z,y.a),y.a*opacity);}",rs="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 y2=2.0*y.rgb;vec3 z=mix(mix(y2,x.rgb,step(0.5*x.rgb,y.rgb)),max(y2-1.0,vec3(0.0)),step(x.rgb,y2-1.0));return mix(x,vec4(z,y.a),y.a*opacity);}",ss="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 z=mix(min(x.rgb*x.rgb/max(1.0-y.rgb,1e-12),1.0),y.rgb,step(1.0,y.rgb));return mix(x,vec4(z,y.a),y.a*opacity);}",is="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(xHSL.x,yHSL.y,xHSL.z));return mix(x,vec4(z,y.a),y.a*opacity);}",ns="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(x.rgb+y.rgb-min(x.rgb*y.rgb,1.0),y.a),y.a*opacity);}",as="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 a=x.rgb;vec3 b=y.rgb;vec3 y2=2.0*b;vec3 w=step(0.5,b);vec3 c=a-(1.0-y2)*a*(1.0-a);vec3 d=mix(a+(y2-1.0)*(sqrt(a)-a),a+(y2-1.0)*a*((16.0*a-12.0)*a+3.0),w*(1.0-step(0.25,a)));vec3 z=mix(c,d,w);return mix(x,vec4(z,y.a),y.a*opacity);}",os="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return y;}",ls="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(max(x.rgb+y.rgb-1.0,0.0),y.a),y.a*opacity);}",cs="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 z=mix(max(1.0-min((1.0-x.rgb)/(2.0*y.rgb),1.0),0.0),min(x.rgb/(2.0*(1.0-y.rgb)),1.0),step(0.5,y.rgb));return mix(x,vec4(z,y.a),y.a*opacity);}",us=new Map([[g.ADD,Ur],[g.AVERAGE,Br],[g.COLOR,Or],[g.COLOR_BURN,Dr],[g.COLOR_DODGE,Lr],[g.DARKEN,kr],[g.DIFFERENCE,jr],[g.DIVIDE,zr],[g.DST,null],[g.EXCLUSION,Hr],[g.HARD_LIGHT,Fr],[g.HARD_MIX,Gr],[g.HUE,Vr],[g.INVERT,Wr],[g.INVERT_RGB,$r],[g.LIGHTEN,qr],[g.LINEAR_BURN,Xr],[g.LINEAR_DODGE,Kr],[g.LINEAR_LIGHT,Yr],[g.LUMINOSITY,Zr],[g.MULTIPLY,Qr],[g.NEGATION,Jr],[g.NORMAL,es],[g.OVERLAY,ts],[g.PIN_LIGHT,rs],[g.REFLECT,ss],[g.SATURATION,is],[g.SCREEN,ns],[g.SOFT_LIGHT,as],[g.SRC,os],[g.SUBTRACT,ls],[g.VIVID_LIGHT,cs]]),ds=class extends Ce{constructor(e,t=1){super(),this._blendFunction=e,this.opacity=new m(t)}getOpacity(){return this.opacity.value}setOpacity(e){this.opacity.value=e}get blendFunction(){return this._blendFunction}set blendFunction(e){this._blendFunction=e,this.dispatchEvent({type:"change"})}getBlendFunction(){return this.blendFunction}setBlendFunction(e){this.blendFunction=e}getShaderCode(){return us.get(this.blendFunction)}},Y=class extends Ce{constructor(e,t,{attributes:r=z.NONE,blendFunction:s=g.NORMAL,defines:o=new Map,uniforms:n=new Map,extensions:i=null,vertexShader:l=null}={}){super(),this.name=e,this.renderer=null,this.attributes=r,this.fragmentShader=t,this.vertexShader=l,this.defines=o,this.uniforms=n,this.extensions=i,this.blendMode=new ds(s),this.blendMode.addEventListener("change",c=>this.setChanged()),this._inputColorSpace=it,this._outputColorSpace=nt}get inputColorSpace(){return this._inputColorSpace}set inputColorSpace(e){this._inputColorSpace=e,this.setChanged()}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e,this.setChanged()}set mainScene(e){}set mainCamera(e){}getName(){return this.name}setRenderer(e){this.renderer=e}getDefines(){return this.defines}getUniforms(){return this.uniforms}getExtensions(){return this.extensions}getBlendMode(){return this.blendMode}getAttributes(){return this.attributes}setAttributes(e){this.attributes=e,this.setChanged()}getFragmentShader(){return this.fragmentShader}setFragmentShader(e){this.fragmentShader=e,this.setChanged()}getVertexShader(){return this.vertexShader}setVertexShader(e){this.vertexShader=e,this.setChanged()}setChanged(){this.dispatchEvent({type:"change"})}setDepthTexture(e,t=re){}update(e,t,r){}setSize(e,t){}initialize(e,t,r){}dispose(){for(const e of Object.keys(this)){const t=this[e];(t instanceof D||t instanceof at||t instanceof ot||t instanceof _)&&this[e].dispose()}}},Oe={MEDIUM:2,LARGE:3},hs=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec4 sum=texture2D(inputBuffer,vUv0);sum+=texture2D(inputBuffer,vUv1);sum+=texture2D(inputBuffer,vUv2);sum+=texture2D(inputBuffer,vUv3);gl_FragColor=sum*0.25;
#include <colorspace_fragment>
}`,fs="uniform vec4 texelSize;uniform float kernel;uniform float scale;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vec2 dUv=(texelSize.xy*vec2(kernel)+texelSize.zw)*scale;vUv0=vec2(uv.x-dUv.x,uv.y+dUv.y);vUv1=vec2(uv.x+dUv.x,uv.y+dUv.y);vUv2=vec2(uv.x+dUv.x,uv.y-dUv.y);vUv3=vec2(uv.x-dUv.x,uv.y-dUv.y);gl_Position=vec4(position.xy,1.0,1.0);}",ps=[new Float32Array([0,0]),new Float32Array([0,1,1]),new Float32Array([0,1,1,2]),new Float32Array([0,1,2,2,3]),new Float32Array([0,1,2,3,4,4,5]),new Float32Array([0,1,2,3,4,5,7,8,9,10])],ms=class extends G{constructor(e=new He){super({name:"KawaseBlurMaterial",uniforms:{inputBuffer:new m(null),texelSize:new m(new He),scale:new m(1),kernel:new m(0)},blending:W,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:hs,vertexShader:fs}),this.setTexelSize(e.x,e.y),this.kernelSize=Oe.MEDIUM}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.inputBuffer=e}get kernelSequence(){return ps[this.kernelSize]}get scale(){return this.uniforms.scale.value}set scale(e){this.uniforms.scale.value=e}getScale(){return this.uniforms.scale.value}setScale(e){this.uniforms.scale.value=e}getKernel(){return null}get kernel(){return this.uniforms.kernel.value}set kernel(e){this.uniforms.kernel.value=e}setKernel(e){this.kernel=e}setTexelSize(e,t){this.uniforms.texelSize.value.set(e,t,e*.5,t*.5)}setSize(e,t){const r=1/e,s=1/t;this.uniforms.texelSize.value.set(r,s,r*.5,s*.5)}},vs=class extends _{constructor({kernelSize:e=Oe.MEDIUM,resolutionScale:t=.5,width:r=A.AUTO_SIZE,height:s=A.AUTO_SIZE,resolutionX:o=r,resolutionY:n=s}={}){super("KawaseBlurPass"),this.renderTargetA=new D(1,1,{depthBuffer:!1}),this.renderTargetA.texture.name="Blur.Target.A",this.renderTargetB=this.renderTargetA.clone(),this.renderTargetB.texture.name="Blur.Target.B";const i=this.resolution=new A(this,o,n,t);i.addEventListener("change",l=>this.setSize(i.baseWidth,i.baseHeight)),this._blurMaterial=new ms,this._blurMaterial.kernelSize=e,this.copyMaterial=new vt}getResolution(){return this.resolution}get blurMaterial(){return this._blurMaterial}set blurMaterial(e){this._blurMaterial=e}get dithering(){return this.copyMaterial.dithering}set dithering(e){this.copyMaterial.dithering=e}get kernelSize(){return this.blurMaterial.kernelSize}set kernelSize(e){this.blurMaterial.kernelSize=e}get width(){return this.resolution.width}set width(e){this.resolution.preferredWidth=e}get height(){return this.resolution.height}set height(e){this.resolution.preferredHeight=e}get scale(){return this.blurMaterial.scale}set scale(e){this.blurMaterial.scale=e}getScale(){return this.blurMaterial.scale}setScale(e){this.blurMaterial.scale=e}getKernelSize(){return this.kernelSize}setKernelSize(e){this.kernelSize=e}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}render(e,t,r,s,o){const n=this.scene,i=this.camera,l=this.renderTargetA,c=this.renderTargetB,u=this.blurMaterial,d=u.kernelSequence;let f=t;this.fullscreenMaterial=u;for(let v=0,p=d.length;v<p;++v){const S=(v&1)===0?l:c;u.kernel=d[v],u.inputBuffer=f.texture,e.setRenderTarget(S),e.render(n,i),f=S}this.fullscreenMaterial=this.copyMaterial,this.copyMaterial.inputBuffer=f.texture,e.setRenderTarget(this.renderToScreen?null:r),e.render(n,i)}setSize(e,t){const r=this.resolution;r.setBaseSize(e,t);const s=r.width,o=r.height;this.renderTargetA.setSize(s,o),this.renderTargetB.setSize(s,o),this.blurMaterial.setSize(e,t)}initialize(e,t,r){r!==void 0&&(this.renderTargetA.texture.type=r,this.renderTargetB.texture.type=r,r!==K?(this.blurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.copyMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1"):e!==null&&e.outputColorSpace===E&&(this.renderTargetA.texture.colorSpace=E,this.renderTargetB.texture.colorSpace=E))}static get AUTO_SIZE(){return A.AUTO_SIZE}},gs=`#include <common>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef RANGE
uniform vec2 range;
#elif defined(THRESHOLD)
uniform float threshold;uniform float smoothing;
#endif
varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);float l=luminance(texel.rgb);float mask=1.0;
#ifdef RANGE
float low=step(range.x,l);float high=step(l,range.y);mask=low*high;
#elif defined(THRESHOLD)
mask=smoothstep(threshold,threshold+smoothing,l);
#endif
#ifdef COLOR
gl_FragColor=texel*mask;
#else
gl_FragColor=vec4(l*mask);
#endif
}`,xs=class extends G{constructor(e=!1,t=null){super({name:"LuminanceMaterial",defines:{THREE_REVISION:Ne.replace(/\D+/g,"")},uniforms:{inputBuffer:new m(null),threshold:new m(0),smoothing:new m(1),range:new m(null)},blending:W,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:gs,vertexShader:Be}),this.colorOutput=e,this.luminanceRange=t}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}get threshold(){return this.uniforms.threshold.value}set threshold(e){this.smoothing>0||e>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.threshold.value=e}getThreshold(){return this.threshold}setThreshold(e){this.threshold=e}get smoothing(){return this.uniforms.smoothing.value}set smoothing(e){this.threshold>0||e>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.smoothing.value=e}getSmoothingFactor(){return this.smoothing}setSmoothingFactor(e){this.smoothing=e}get useThreshold(){return this.threshold>0||this.smoothing>0}set useThreshold(e){}get colorOutput(){return this.defines.COLOR!==void 0}set colorOutput(e){e?this.defines.COLOR="1":delete this.defines.COLOR,this.needsUpdate=!0}isColorOutputEnabled(e){return this.colorOutput}setColorOutputEnabled(e){this.colorOutput=e}get useRange(){return this.luminanceRange!==null}set useRange(e){this.luminanceRange=null}get luminanceRange(){return this.uniforms.range.value}set luminanceRange(e){e!==null?this.defines.RANGE="1":delete this.defines.RANGE,this.uniforms.range.value=e,this.needsUpdate=!0}getLuminanceRange(){return this.luminanceRange}setLuminanceRange(e){this.luminanceRange=e}},yt=class extends _{constructor({renderTarget:e,luminanceRange:t,colorOutput:r,resolutionScale:s=1,width:o=A.AUTO_SIZE,height:n=A.AUTO_SIZE,resolutionX:i=o,resolutionY:l=n}={}){super("LuminancePass"),this.fullscreenMaterial=new xs(r,t),this.needsSwap=!1,this.renderTarget=e,this.renderTarget===void 0&&(this.renderTarget=new D(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="LuminancePass.Target");const c=this.resolution=new A(this,i,l,s);c.addEventListener("change",u=>this.setSize(c.baseWidth,c.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}render(e,t,r,s,o){const n=this.fullscreenMaterial;n.inputBuffer=t.texture,e.setRenderTarget(this.renderToScreen?null:this.renderTarget),e.render(this.scene,this.camera)}setSize(e,t){const r=this.resolution;r.setBaseSize(e,t),this.renderTarget.setSize(r.width,r.height)}initialize(e,t,r){r!==void 0&&r!==K&&(this.renderTarget.texture.type=r,this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},ys=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#define WEIGHT_INNER 0.125
#define WEIGHT_OUTER 0.0555555
varying vec2 vUv;varying vec2 vUv00;varying vec2 vUv01;varying vec2 vUv02;varying vec2 vUv03;varying vec2 vUv04;varying vec2 vUv05;varying vec2 vUv06;varying vec2 vUv07;varying vec2 vUv08;varying vec2 vUv09;varying vec2 vUv10;varying vec2 vUv11;float clampToBorder(const in vec2 uv){return float(uv.s>=0.0&&uv.s<=1.0&&uv.t>=0.0&&uv.t<=1.0);}void main(){vec4 c=vec4(0.0);vec4 w=WEIGHT_INNER*vec4(clampToBorder(vUv00),clampToBorder(vUv01),clampToBorder(vUv02),clampToBorder(vUv03));c+=w.x*texture2D(inputBuffer,vUv00);c+=w.y*texture2D(inputBuffer,vUv01);c+=w.z*texture2D(inputBuffer,vUv02);c+=w.w*texture2D(inputBuffer,vUv03);w=WEIGHT_OUTER*vec4(clampToBorder(vUv04),clampToBorder(vUv05),clampToBorder(vUv06),clampToBorder(vUv07));c+=w.x*texture2D(inputBuffer,vUv04);c+=w.y*texture2D(inputBuffer,vUv05);c+=w.z*texture2D(inputBuffer,vUv06);c+=w.w*texture2D(inputBuffer,vUv07);w=WEIGHT_OUTER*vec4(clampToBorder(vUv08),clampToBorder(vUv09),clampToBorder(vUv10),clampToBorder(vUv11));c+=w.x*texture2D(inputBuffer,vUv08);c+=w.y*texture2D(inputBuffer,vUv09);c+=w.z*texture2D(inputBuffer,vUv10);c+=w.w*texture2D(inputBuffer,vUv11);c+=WEIGHT_OUTER*texture2D(inputBuffer,vUv);gl_FragColor=c;
#include <colorspace_fragment>
}`,bs="uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv00;varying vec2 vUv01;varying vec2 vUv02;varying vec2 vUv03;varying vec2 vUv04;varying vec2 vUv05;varying vec2 vUv06;varying vec2 vUv07;varying vec2 vUv08;varying vec2 vUv09;varying vec2 vUv10;varying vec2 vUv11;void main(){vUv=position.xy*0.5+0.5;vUv00=vUv+texelSize*vec2(-1.0,1.0);vUv01=vUv+texelSize*vec2(1.0,1.0);vUv02=vUv+texelSize*vec2(-1.0,-1.0);vUv03=vUv+texelSize*vec2(1.0,-1.0);vUv04=vUv+texelSize*vec2(-2.0,2.0);vUv05=vUv+texelSize*vec2(0.0,2.0);vUv06=vUv+texelSize*vec2(2.0,2.0);vUv07=vUv+texelSize*vec2(-2.0,0.0);vUv08=vUv+texelSize*vec2(2.0,0.0);vUv09=vUv+texelSize*vec2(-2.0,-2.0);vUv10=vUv+texelSize*vec2(0.0,-2.0);vUv11=vUv+texelSize*vec2(2.0,-2.0);gl_Position=vec4(position.xy,1.0,1.0);}",Ts=class extends G{constructor(){super({name:"DownsamplingMaterial",uniforms:{inputBuffer:new m(null),texelSize:new m(new w)},blending:W,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:ys,vertexShader:bs})}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setSize(e,t){this.uniforms.texelSize.value.set(1/e,1/t)}},Ss=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;uniform mediump sampler2D supportBuffer;
#else
uniform lowp sampler2D inputBuffer;uniform lowp sampler2D supportBuffer;
#endif
uniform float radius;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;varying vec2 vUv6;varying vec2 vUv7;void main(){vec4 c=vec4(0.0);c+=texture2D(inputBuffer,vUv0)*0.0625;c+=texture2D(inputBuffer,vUv1)*0.125;c+=texture2D(inputBuffer,vUv2)*0.0625;c+=texture2D(inputBuffer,vUv3)*0.125;c+=texture2D(inputBuffer,vUv)*0.25;c+=texture2D(inputBuffer,vUv4)*0.125;c+=texture2D(inputBuffer,vUv5)*0.0625;c+=texture2D(inputBuffer,vUv6)*0.125;c+=texture2D(inputBuffer,vUv7)*0.0625;vec4 baseColor=texture2D(supportBuffer,vUv);gl_FragColor=mix(baseColor,c,radius);
#include <colorspace_fragment>
}`,ws="uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;varying vec2 vUv6;varying vec2 vUv7;void main(){vUv=position.xy*0.5+0.5;vUv0=vUv+texelSize*vec2(-1.0,1.0);vUv1=vUv+texelSize*vec2(0.0,1.0);vUv2=vUv+texelSize*vec2(1.0,1.0);vUv3=vUv+texelSize*vec2(-1.0,0.0);vUv4=vUv+texelSize*vec2(1.0,0.0);vUv5=vUv+texelSize*vec2(-1.0,-1.0);vUv6=vUv+texelSize*vec2(0.0,-1.0);vUv7=vUv+texelSize*vec2(1.0,-1.0);gl_Position=vec4(position.xy,1.0,1.0);}",Es=class extends G{constructor(){super({name:"UpsamplingMaterial",uniforms:{inputBuffer:new m(null),supportBuffer:new m(null),texelSize:new m(new w),radius:new m(.85)},blending:W,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:Ss,vertexShader:ws})}set inputBuffer(e){this.uniforms.inputBuffer.value=e}set supportBuffer(e){this.uniforms.supportBuffer.value=e}get radius(){return this.uniforms.radius.value}set radius(e){this.uniforms.radius.value=e}setSize(e,t){this.uniforms.texelSize.value.set(1/e,1/t)}},Ms=class extends _{constructor(){super("MipmapBlurPass"),this.needsSwap=!1,this.renderTarget=new D(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="Upsampling.Mipmap0",this.downsamplingMipmaps=[],this.upsamplingMipmaps=[],this.downsamplingMaterial=new Ts,this.upsamplingMaterial=new Es,this.resolution=new w}get texture(){return this.renderTarget.texture}get levels(){return this.downsamplingMipmaps.length}set levels(e){if(this.levels!==e){const t=this.renderTarget;this.dispose(),this.downsamplingMipmaps=[],this.upsamplingMipmaps=[];for(let r=0;r<e;++r){const s=t.clone();s.texture.name="Downsampling.Mipmap"+r,this.downsamplingMipmaps.push(s)}this.upsamplingMipmaps.push(t);for(let r=1,s=e-1;r<s;++r){const o=t.clone();o.texture.name="Upsampling.Mipmap"+r,this.upsamplingMipmaps.push(o)}this.setSize(this.resolution.x,this.resolution.y)}}get radius(){return this.upsamplingMaterial.radius}set radius(e){this.upsamplingMaterial.radius=e}render(e,t,r,s,o){const{scene:n,camera:i}=this,{downsamplingMaterial:l,upsamplingMaterial:c}=this,{downsamplingMipmaps:u,upsamplingMipmaps:d}=this;let f=t;this.fullscreenMaterial=l;for(let v=0,p=u.length;v<p;++v){const S=u[v];l.setSize(f.width,f.height),l.inputBuffer=f.texture,e.setRenderTarget(S),e.render(n,i),f=S}this.fullscreenMaterial=c;for(let v=d.length-1;v>=0;--v){const p=d[v];c.setSize(f.width,f.height),c.inputBuffer=f.texture,c.supportBuffer=u[v].texture,e.setRenderTarget(p),e.render(n,i),f=p}}setSize(e,t){const r=this.resolution;r.set(e,t);let s=r.width,o=r.height;for(let n=0,i=this.downsamplingMipmaps.length;n<i;++n)s=Math.round(s*.5),o=Math.round(o*.5),this.downsamplingMipmaps[n].setSize(s,o),n<this.upsamplingMipmaps.length&&this.upsamplingMipmaps[n].setSize(s,o)}initialize(e,t,r){if(r!==void 0){const s=this.downsamplingMipmaps.concat(this.upsamplingMipmaps);for(const o of s)o.texture.type=r;if(r!==K)this.downsamplingMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.upsamplingMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1";else if(e!==null&&e.outputColorSpace===E)for(const o of s)o.texture.colorSpace=E}}dispose(){super.dispose();for(const e of this.downsamplingMipmaps.concat(this.upsamplingMipmaps))e.dispose()}},As=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D map;
#else
uniform lowp sampler2D map;
#endif
uniform float intensity;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec4 texel=texture2D(map,uv);outputColor=vec4(texel.rgb*intensity,max(inputColor.a,texel.a));}`,Rs=class extends Y{constructor({blendFunction:e=g.SCREEN,luminanceThreshold:t=1,luminanceSmoothing:r=.03,mipmapBlur:s=!0,intensity:o=1,radius:n=.85,levels:i=8,kernelSize:l=Oe.LARGE,resolutionScale:c=.5,width:u=A.AUTO_SIZE,height:d=A.AUTO_SIZE,resolutionX:f=u,resolutionY:v=d}={}){super("BloomEffect",As,{blendFunction:e,uniforms:new Map([["map",new m(null)],["intensity",new m(o)]])}),this.renderTarget=new D(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="Bloom.Target",this.blurPass=new vs({kernelSize:l}),this.luminancePass=new yt({colorOutput:!0}),this.luminanceMaterial.threshold=t,this.luminanceMaterial.smoothing=r,this.mipmapBlurPass=new Ms,this.mipmapBlurPass.enabled=s,this.mipmapBlurPass.radius=n,this.mipmapBlurPass.levels=i,this.uniforms.get("map").value=s?this.mipmapBlurPass.texture:this.renderTarget.texture;const p=this.resolution=new A(this,f,v,c);p.addEventListener("change",S=>this.setSize(p.baseWidth,p.baseHeight))}get texture(){return this.mipmapBlurPass.enabled?this.mipmapBlurPass.texture:this.renderTarget.texture}getTexture(){return this.texture}getResolution(){return this.resolution}getBlurPass(){return this.blurPass}getLuminancePass(){return this.luminancePass}get luminanceMaterial(){return this.luminancePass.fullscreenMaterial}getLuminanceMaterial(){return this.luminancePass.fullscreenMaterial}get width(){return this.resolution.width}set width(e){this.resolution.preferredWidth=e}get height(){return this.resolution.height}set height(e){this.resolution.preferredHeight=e}get dithering(){return this.blurPass.dithering}set dithering(e){this.blurPass.dithering=e}get kernelSize(){return this.blurPass.kernelSize}set kernelSize(e){this.blurPass.kernelSize=e}get distinction(){return console.warn(this.name,"distinction was removed"),1}set distinction(e){console.warn(this.name,"distinction was removed")}get intensity(){return this.uniforms.get("intensity").value}set intensity(e){this.uniforms.get("intensity").value=e}getIntensity(){return this.intensity}setIntensity(e){this.intensity=e}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}update(e,t,r){const s=this.renderTarget,o=this.luminancePass;o.enabled?(o.render(e,t),this.mipmapBlurPass.enabled?this.mipmapBlurPass.render(e,o.renderTarget):this.blurPass.render(e,o.renderTarget,s)):this.mipmapBlurPass.enabled?this.mipmapBlurPass.render(e,t):this.blurPass.render(e,t,s)}setSize(e,t){const r=this.resolution;r.setBaseSize(e,t),this.renderTarget.setSize(r.width,r.height),this.blurPass.resolution.copy(r),this.luminancePass.setSize(e,t),this.mipmapBlurPass.setSize(e,t)}initialize(e,t,r){this.blurPass.initialize(e,t,r),this.luminancePass.initialize(e,t,r),this.mipmapBlurPass.initialize(e,t,r),r!==void 0&&(this.renderTarget.texture.type=r,e!==null&&e.outputColorSpace===E&&(this.renderTarget.texture.colorSpace=E))}},_s=`#ifdef RADIAL_MODULATION
uniform float modulationOffset;
#endif
varying float vActive;varying vec2 vUvR;varying vec2 vUvB;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec2 ra=inputColor.ra;vec2 ba=inputColor.ba;
#ifdef RADIAL_MODULATION
const vec2 center=vec2(0.5);float d=distance(uv,center)*2.0;d=max(d-modulationOffset,0.0);if(vActive>0.0&&d>0.0){ra=texture2D(inputBuffer,mix(uv,vUvR,d)).ra;ba=texture2D(inputBuffer,mix(uv,vUvB,d)).ba;}
#else
if(vActive>0.0){ra=texture2D(inputBuffer,vUvR).ra;ba=texture2D(inputBuffer,vUvB).ba;}
#endif
outputColor=vec4(ra.x,inputColor.g,ba.x,max(max(ra.y,ba.y),inputColor.a));}`,Cs="uniform vec2 offset;varying float vActive;varying vec2 vUvR;varying vec2 vUvB;void mainSupport(const in vec2 uv){vec2 shift=offset*vec2(1.0,aspect);vActive=(shift.x!=0.0||shift.y!=0.0)?1.0:0.0;vUvR=uv+shift;vUvB=uv-shift;}",Ns=class extends Y{constructor({offset:e=new w(.001,5e-4),radialModulation:t=!1,modulationOffset:r=.15}={}){super("ChromaticAberrationEffect",_s,{vertexShader:Cs,attributes:z.CONVOLUTION,uniforms:new Map([["offset",new m(e)],["modulationOffset",new m(r)]])}),this.radialModulation=t}get offset(){return this.uniforms.get("offset").value}set offset(e){this.uniforms.get("offset").value=e}get radialModulation(){return this.defines.has("RADIAL_MODULATION")}set radialModulation(e){e?this.defines.set("RADIAL_MODULATION","1"):this.defines.delete("RADIAL_MODULATION"),this.setChanged()}get modulationOffset(){return this.uniforms.get("modulationOffset").value}set modulationOffset(e){this.uniforms.get("modulationOffset").value=e}getOffset(){return this.offset}setOffset(e){this.offset=e}},bt=class extends _{constructor(e,t,r=null){super("RenderPass",e,t),this.needsSwap=!1,this.clearPass=new xt,this.overrideMaterialManager=r===null?null:new Ze(r),this.ignoreBackground=!1,this.skipShadowMapUpdate=!1,this.selection=null}set mainScene(e){this.scene=e}set mainCamera(e){this.camera=e}get renderToScreen(){return super.renderToScreen}set renderToScreen(e){super.renderToScreen=e,this.clearPass.renderToScreen=e}get overrideMaterial(){const e=this.overrideMaterialManager;return e!==null?e.material:null}set overrideMaterial(e){const t=this.overrideMaterialManager;e!==null?t!==null?t.setMaterial(e):this.overrideMaterialManager=new Ze(e):t!==null&&(t.dispose(),this.overrideMaterialManager=null)}getOverrideMaterial(){return this.overrideMaterial}setOverrideMaterial(e){this.overrideMaterial=e}get clear(){return this.clearPass.enabled}set clear(e){this.clearPass.enabled=e}getSelection(){return this.selection}setSelection(e){this.selection=e}isBackgroundDisabled(){return this.ignoreBackground}setBackgroundDisabled(e){this.ignoreBackground=e}isShadowMapDisabled(){return this.skipShadowMapUpdate}setShadowMapDisabled(e){this.skipShadowMapUpdate=e}getClearPass(){return this.clearPass}render(e,t,r,s,o){const n=this.scene,i=this.camera,l=this.selection,c=i.layers.mask,u=n.background,d=e.shadowMap.autoUpdate,f=this.renderToScreen?null:t;l!==null&&i.layers.set(l.getLayer()),this.skipShadowMapUpdate&&(e.shadowMap.autoUpdate=!1),(this.ignoreBackground||this.clearPass.overrideClearColor!==null)&&(n.background=null),this.clearPass.enabled&&this.clearPass.render(e,t),e.setRenderTarget(f),this.overrideMaterialManager!==null?this.overrideMaterialManager.render(e,n,i):e.render(n,i),i.layers.mask=c,n.background=u,e.shadowMap.autoUpdate=d}},P={LINEAR:0,REINHARD:1,REINHARD2:2,REINHARD2_ADAPTIVE:3,OPTIMIZED_CINEON:5,CINEON:5,ACES_FILMIC:6,AGX:7,NEUTRAL:8},ne={DEFAULT:0,ESKIL:1},Ps=`void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 noise=vec3(rand(uv*(1.0+time)));
#ifdef PREMULTIPLY
outputColor=vec4(min(inputColor.rgb*noise,vec3(1.0)),inputColor.a);
#else
outputColor=vec4(noise,inputColor.a);
#endif
}`,fn=class extends Y{constructor({blendFunction:e=g.SCREEN,premultiply:t=!1}={}){super("NoiseEffect",Ps,{blendFunction:e}),this.premultiply=t}get premultiply(){return this.defines.has("PREMULTIPLY")}set premultiply(e){this.premultiply!==e&&(e?this.defines.set("PREMULTIPLY","1"):this.defines.delete("PREMULTIPLY"),this.setChanged())}isPremultiplied(){return this.premultiply}setPremultiplied(e){this.premultiply=e}},Is=`#include <packing>
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
#ifdef DOWNSAMPLE_NORMALS
uniform lowp sampler2D normalBuffer;
#endif
varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}int findBestDepth(const in float samples[4]){float c=(samples[0]+samples[1]+samples[2]+samples[3])*0.25;float distances[4];distances[0]=abs(c-samples[0]);distances[1]=abs(c-samples[1]);distances[2]=abs(c-samples[2]);distances[3]=abs(c-samples[3]);float maxDistance=max(max(distances[0],distances[1]),max(distances[2],distances[3]));int remaining[3];int rejected[3];int i,j,k;for(i=0,j=0,k=0;i<4;++i){if(distances[i]<maxDistance){remaining[j++]=i;}else{rejected[k++]=i;}}for(;j<3;++j){remaining[j]=rejected[--k];}vec3 s=vec3(samples[remaining[0]],samples[remaining[1]],samples[remaining[2]]);c=(s.x+s.y+s.z)/3.0;distances[0]=abs(c-s.x);distances[1]=abs(c-s.y);distances[2]=abs(c-s.z);float minDistance=min(distances[0],min(distances[1],distances[2]));for(i=0;i<3;++i){if(distances[i]==minDistance){break;}}return remaining[i];}void main(){float d[4];d[0]=readDepth(vUv0);d[1]=readDepth(vUv1);d[2]=readDepth(vUv2);d[3]=readDepth(vUv3);int index=findBestDepth(d);
#ifdef DOWNSAMPLE_NORMALS
vec3 n[4];n[0]=texture2D(normalBuffer,vUv0).rgb;n[1]=texture2D(normalBuffer,vUv1).rgb;n[2]=texture2D(normalBuffer,vUv2).rgb;n[3]=texture2D(normalBuffer,vUv3).rgb;
#else
vec3 n[4];n[0]=vec3(0.0);n[1]=vec3(0.0);n[2]=vec3(0.0);n[3]=vec3(0.0);
#endif
gl_FragColor=vec4(n[index],d[index]);}`,Us="uniform vec2 texelSize;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vUv0=uv;vUv1=vec2(uv.x,uv.y+texelSize.y);vUv2=vec2(uv.x+texelSize.x,uv.y);vUv3=uv+texelSize;gl_Position=vec4(position.xy,1.0,1.0);}",Bs=class extends G{constructor(){super({name:"DepthDownsamplingMaterial",defines:{DEPTH_PACKING:"0"},uniforms:{depthBuffer:new m(null),normalBuffer:new m(null),texelSize:new m(new w)},blending:W,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:Is,vertexShader:Us})}set depthBuffer(e){this.uniforms.depthBuffer.value=e}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e,t=re){this.depthBuffer=e,this.depthPacking=t}set normalBuffer(e){this.uniforms.normalBuffer.value=e,e!==null?this.defines.DOWNSAMPLE_NORMALS="1":delete this.defines.DOWNSAMPLE_NORMALS,this.needsUpdate=!0}setNormalBuffer(e){this.normalBuffer=e}setTexelSize(e,t){this.uniforms.texelSize.value.set(e,t)}setSize(e,t){this.uniforms.texelSize.value.set(1/e,1/t)}},Os=class extends _{constructor({normalBuffer:e=null,resolutionScale:t=.5,width:r=A.AUTO_SIZE,height:s=A.AUTO_SIZE,resolutionX:o=r,resolutionY:n=s}={}){super("DepthDownsamplingPass");const i=new Bs;i.normalBuffer=e,this.fullscreenMaterial=i,this.needsDepthTexture=!0,this.needsSwap=!1,this.renderTarget=new D(1,1,{minFilter:te,magFilter:te,depthBuffer:!1,type:Nt}),this.renderTarget.texture.name="DepthDownsamplingPass.Target",this.renderTarget.texture.generateMipmaps=!1;const l=this.resolution=new A(this,o,n,t);l.addEventListener("change",c=>this.setSize(l.baseWidth,l.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}setDepthTexture(e,t=re){this.fullscreenMaterial.depthBuffer=e,this.fullscreenMaterial.depthPacking=t}render(e,t,r,s,o){e.setRenderTarget(this.renderToScreen?null:this.renderTarget),e.render(this.scene,this.camera)}setSize(e,t){const r=this.resolution;r.setBaseSize(e,t),this.renderTarget.setSize(r.width,r.height),this.fullscreenMaterial.setSize(e,t)}initialize(e,t,r){const s=e.getContext();if(!(s.getExtension("EXT_color_buffer_float")||s.getExtension("EXT_color_buffer_half_float")))throw new Error("Rendering to float texture is not supported.")}},Ds=`#include <packing>
#define packFloatToRGBA(v) packDepthToRGBA(v)
#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)
uniform lowp sampler2D luminanceBuffer0;uniform lowp sampler2D luminanceBuffer1;uniform float minLuminance;uniform float deltaTime;uniform float tau;varying vec2 vUv;void main(){float l0=unpackRGBAToFloat(texture2D(luminanceBuffer0,vUv));
#if __VERSION__ < 300
float l1=texture2DLodEXT(luminanceBuffer1,vUv,MIP_LEVEL_1X1).r;
#else
float l1=textureLod(luminanceBuffer1,vUv,MIP_LEVEL_1X1).r;
#endif
l0=max(minLuminance,l0);l1=max(minLuminance,l1);float adaptedLum=l0+(l1-l0)*(1.0-exp(-deltaTime*tau));gl_FragColor=(adaptedLum==1.0)?vec4(1.0):packFloatToRGBA(adaptedLum);}`,Ls=class extends G{constructor(){super({name:"AdaptiveLuminanceMaterial",defines:{MIP_LEVEL_1X1:"0.0"},uniforms:{luminanceBuffer0:new m(null),luminanceBuffer1:new m(null),minLuminance:new m(.01),deltaTime:new m(0),tau:new m(1)},extensions:{shaderTextureLOD:!0},blending:W,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:Ds,vertexShader:Be})}set luminanceBuffer0(e){this.uniforms.luminanceBuffer0.value=e}setLuminanceBuffer0(e){this.uniforms.luminanceBuffer0.value=e}set luminanceBuffer1(e){this.uniforms.luminanceBuffer1.value=e}setLuminanceBuffer1(e){this.uniforms.luminanceBuffer1.value=e}set mipLevel1x1(e){this.defines.MIP_LEVEL_1X1=e.toFixed(1),this.needsUpdate=!0}setMipLevel1x1(e){this.mipLevel1x1=e}set deltaTime(e){this.uniforms.deltaTime.value=e}setDeltaTime(e){this.uniforms.deltaTime.value=e}get minLuminance(){return this.uniforms.minLuminance.value}set minLuminance(e){this.uniforms.minLuminance.value=e}getMinLuminance(){return this.uniforms.minLuminance.value}setMinLuminance(e){this.uniforms.minLuminance.value=e}get adaptationRate(){return this.uniforms.tau.value}set adaptationRate(e){this.uniforms.tau.value=e}getAdaptationRate(){return this.uniforms.tau.value}setAdaptationRate(e){this.uniforms.tau.value=e}},ks=class extends _{constructor(e,{minLuminance:t=.01,adaptationRate:r=1}={}){super("AdaptiveLuminancePass"),this.fullscreenMaterial=new Ls,this.needsSwap=!1,this.renderTargetPrevious=new D(1,1,{minFilter:te,magFilter:te,depthBuffer:!1}),this.renderTargetPrevious.texture.name="Luminance.Previous";const s=this.fullscreenMaterial;s.luminanceBuffer0=this.renderTargetPrevious.texture,s.luminanceBuffer1=e,s.minLuminance=t,s.adaptationRate=r,this.renderTargetAdapted=this.renderTargetPrevious.clone(),this.renderTargetAdapted.texture.name="Luminance.Adapted",this.copyPass=new gt(this.renderTargetPrevious,!1)}get texture(){return this.renderTargetAdapted.texture}getTexture(){return this.renderTargetAdapted.texture}set mipLevel1x1(e){this.fullscreenMaterial.mipLevel1x1=e}get adaptationRate(){return this.fullscreenMaterial.adaptationRate}set adaptationRate(e){this.fullscreenMaterial.adaptationRate=e}render(e,t,r,s,o){this.fullscreenMaterial.deltaTime=s,e.setRenderTarget(this.renderToScreen?null:this.renderTargetAdapted),e.render(this.scene,this.camera),this.copyPass.render(e,this.renderTargetAdapted)}},js=`#include <tonemapping_pars_fragment>
uniform float whitePoint;
#if TONE_MAPPING_MODE == 2 || TONE_MAPPING_MODE == 3
uniform float middleGrey;
#if TONE_MAPPING_MODE == 3
uniform lowp sampler2D luminanceBuffer;
#else
uniform float averageLuminance;
#endif
vec3 Reinhard2ToneMapping(vec3 color){color*=toneMappingExposure;float l=luminance(color);
#if TONE_MAPPING_MODE == 3
float lumAvg=unpackRGBAToFloat(texture2D(luminanceBuffer,vec2(0.5)));
#else
float lumAvg=averageLuminance;
#endif
float lumScaled=(l*middleGrey)/max(lumAvg,1e-6);float lumCompressed=lumScaled*(1.0+lumScaled/(whitePoint*whitePoint));lumCompressed/=(1.0+lumScaled);return clamp(lumCompressed*color,0.0,1.0);}
#elif TONE_MAPPING_MODE == 4
#define A 0.15
#define B 0.50
#define C 0.10
#define D 0.20
#define E 0.02
#define F 0.30
vec3 Uncharted2Helper(const in vec3 x){return((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}vec3 Uncharted2ToneMapping(vec3 color){color*=toneMappingExposure;return clamp(Uncharted2Helper(color)/Uncharted2Helper(vec3(whitePoint)),0.0,1.0);}
#endif
void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){
#if TONE_MAPPING_MODE == 2 || TONE_MAPPING_MODE == 3
outputColor=vec4(Reinhard2ToneMapping(inputColor.rgb),inputColor.a);
#elif TONE_MAPPING_MODE == 4
outputColor=vec4(Uncharted2ToneMapping(inputColor.rgb),inputColor.a);
#else
outputColor=vec4(toneMapping(inputColor.rgb),inputColor.a);
#endif
}`,zs=class extends Y{constructor({blendFunction:e=g.SRC,adaptive:t=!1,mode:r=t?P.REINHARD2_ADAPTIVE:P.AGX,resolution:s=256,maxLuminance:o=4,whitePoint:n=o,middleGrey:i=.6,minLuminance:l=.01,averageLuminance:c=1,adaptationRate:u=1}={}){super("ToneMappingEffect",js,{blendFunction:e,uniforms:new Map([["luminanceBuffer",new m(null)],["maxLuminance",new m(o)],["whitePoint",new m(n)],["middleGrey",new m(i)],["averageLuminance",new m(c)]])}),this.renderTargetLuminance=new D(1,1,{minFilter:Lt,depthBuffer:!1}),this.renderTargetLuminance.texture.generateMipmaps=!0,this.renderTargetLuminance.texture.name="Luminance",this.luminancePass=new yt({renderTarget:this.renderTargetLuminance}),this.adaptiveLuminancePass=new ks(this.luminancePass.texture,{minLuminance:l,adaptationRate:u}),this.uniforms.get("luminanceBuffer").value=this.adaptiveLuminancePass.texture,this.resolution=s,this.mode=r}get mode(){return Number(this.defines.get("TONE_MAPPING_MODE"))}set mode(e){if(this.mode===e)return;const r=Ne.replace(/\D+/g,"")>=168?"CineonToneMapping(texel)":"OptimizedCineonToneMapping(texel)";switch(this.defines.clear(),this.defines.set("TONE_MAPPING_MODE",e.toFixed(0)),e){case P.LINEAR:this.defines.set("toneMapping(texel)","LinearToneMapping(texel)");break;case P.REINHARD:this.defines.set("toneMapping(texel)","ReinhardToneMapping(texel)");break;case P.CINEON:case P.OPTIMIZED_CINEON:this.defines.set("toneMapping(texel)",r);break;case P.ACES_FILMIC:this.defines.set("toneMapping(texel)","ACESFilmicToneMapping(texel)");break;case P.AGX:this.defines.set("toneMapping(texel)","AgXToneMapping(texel)");break;case P.NEUTRAL:this.defines.set("toneMapping(texel)","NeutralToneMapping(texel)");break;default:this.defines.set("toneMapping(texel)","texel");break}this.adaptiveLuminancePass.enabled=e===P.REINHARD2_ADAPTIVE,this.setChanged()}getMode(){return this.mode}setMode(e){this.mode=e}get whitePoint(){return this.uniforms.get("whitePoint").value}set whitePoint(e){this.uniforms.get("whitePoint").value=e}get middleGrey(){return this.uniforms.get("middleGrey").value}set middleGrey(e){this.uniforms.get("middleGrey").value=e}get averageLuminance(){return this.uniforms.get("averageLuminance").value}set averageLuminance(e){this.uniforms.get("averageLuminance").value=e}get adaptiveLuminanceMaterial(){return this.adaptiveLuminancePass.fullscreenMaterial}getAdaptiveLuminanceMaterial(){return this.adaptiveLuminanceMaterial}get resolution(){return this.luminancePass.resolution.width}set resolution(e){const t=Math.max(0,Math.ceil(Math.log2(e))),r=Math.pow(2,t);this.luminancePass.resolution.setPreferredSize(r,r),this.adaptiveLuminanceMaterial.mipLevel1x1=t}getResolution(){return this.resolution}setResolution(e){this.resolution=e}get adaptive(){return this.mode===P.REINHARD2_ADAPTIVE}set adaptive(e){this.mode=e?P.REINHARD2_ADAPTIVE:P.REINHARD2}get adaptationRate(){return this.adaptiveLuminanceMaterial.adaptationRate}set adaptationRate(e){this.adaptiveLuminanceMaterial.adaptationRate=e}get distinction(){return console.warn(this.name,"distinction was removed."),1}set distinction(e){console.warn(this.name,"distinction was removed.")}update(e,t,r){this.adaptiveLuminancePass.enabled&&(this.luminancePass.render(e,t),this.adaptiveLuminancePass.render(e,null,null,r))}initialize(e,t,r){this.adaptiveLuminancePass.initialize(e,t,r)}},Hs=`uniform float offset;uniform float darkness;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){const vec2 center=vec2(0.5);vec3 color=inputColor.rgb;
#if VIGNETTE_TECHNIQUE == 0
float d=distance(uv,center);color*=smoothstep(0.8,offset*0.799,d*(darkness+offset));
#else
vec2 coord=(uv-center)*vec2(offset);color=mix(color,vec3(1.0-darkness),dot(coord,coord));
#endif
outputColor=vec4(color,inputColor.a);}`,Fs=class extends Y{constructor({blendFunction:e,eskil:t=!1,technique:r=t?ne.ESKIL:ne.DEFAULT,offset:s=.5,darkness:o=.5}={}){super("VignetteEffect",Hs,{blendFunction:e,defines:new Map([["VIGNETTE_TECHNIQUE",r.toFixed(0)]]),uniforms:new Map([["offset",new m(s)],["darkness",new m(o)]])})}get technique(){return Number(this.defines.get("VIGNETTE_TECHNIQUE"))}set technique(e){this.technique!==e&&(this.defines.set("VIGNETTE_TECHNIQUE",e.toFixed(0)),this.setChanged())}get eskil(){return this.technique===ne.ESKIL}set eskil(e){this.technique=e?ne.ESKIL:ne.DEFAULT}getTechnique(){return this.technique}setTechnique(e){this.technique=e}get offset(){return this.uniforms.get("offset").value}set offset(e){this.uniforms.get("offset").value=e}getOffset(){return this.offset}setOffset(e){this.offset=e}get darkness(){return this.uniforms.get("darkness").value}set darkness(e){this.uniforms.get("darkness").value=e}getDarkness(){return this.darkness}setDarkness(e){this.darkness=e}},Gs=`#include <common>
#include <packing>
#include <dithering_pars_fragment>
#define packFloatToRGBA(v) packDepthToRGBA(v)
#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#if DEPTH_PACKING == 3201
uniform lowp sampler2D depthBuffer;
#elif defined(GL_FRAGMENT_PRECISION_HIGH)
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;vec4 sRGBToLinear(const in vec4 value){return vec4(mix(pow(value.rgb*0.9478672986+vec3(0.0521327014),vec3(2.4)),value.rgb*0.0773993808,vec3(lessThanEqual(value.rgb,vec3(0.04045)))),value.a);}float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
float depth=unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
float depth=texture2D(depthBuffer,uv).r;
#endif
#if defined(USE_LOGARITHMIC_DEPTH_BUFFER) || defined(LOG_DEPTH)
float d=pow(2.0,depth*log2(cameraFar+1.0))-1.0;float a=cameraFar/(cameraFar-cameraNear);float b=cameraFar*cameraNear/(cameraNear-cameraFar);depth=a+b/d;
#elif defined(USE_REVERSED_DEPTH_BUFFER)
depth=1.0-depth;
#endif
return depth;}float getViewZ(const in float depth){
#ifdef PERSPECTIVE_CAMERA
return perspectiveDepthToViewZ(depth,cameraNear,cameraFar);
#else
return orthographicDepthToViewZ(depth,cameraNear,cameraFar);
#endif
}vec3 RGBToHCV(const in vec3 RGB){vec4 P=mix(vec4(RGB.bg,-1.0,2.0/3.0),vec4(RGB.gb,0.0,-1.0/3.0),step(RGB.b,RGB.g));vec4 Q=mix(vec4(P.xyw,RGB.r),vec4(RGB.r,P.yzx),step(P.x,RGB.r));float C=Q.x-min(Q.w,Q.y);float H=abs((Q.w-Q.y)/(6.0*C+EPSILON)+Q.z);return vec3(H,C,Q.x);}vec3 RGBToHSL(const in vec3 RGB){vec3 HCV=RGBToHCV(RGB);float L=HCV.z-HCV.y*0.5;float S=HCV.y/(1.0-abs(L*2.0-1.0)+EPSILON);return vec3(HCV.x,S,L);}vec3 HueToRGB(const in float H){float R=abs(H*6.0-3.0)-1.0;float G=2.0-abs(H*6.0-2.0);float B=2.0-abs(H*6.0-4.0);return clamp(vec3(R,G,B),0.0,1.0);}vec3 HSLToRGB(const in vec3 HSL){vec3 RGB=HueToRGB(HSL.x);float C=(1.0-abs(2.0*HSL.z-1.0))*HSL.y;return(RGB-0.5)*C+HSL.z;}FRAGMENT_HEAD void main(){FRAGMENT_MAIN_UV vec4 color0=texture2D(inputBuffer,UV);vec4 color1=vec4(0.0);FRAGMENT_MAIN_IMAGE color0.a=clamp(color0.a,0.0,1.0);gl_FragColor=color0;
#ifdef ENCODE_OUTPUT
#include <colorspace_fragment>
#endif
#include <dithering_fragment>
}`,Vs="uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;VERTEX_HEAD void main(){vUv=position.xy*0.5+0.5;VERTEX_MAIN_SUPPORT gl_Position=vec4(position.xy,1.0,1.0);}",Ws=class extends G{constructor(e,t,r,s,o=!1){super({name:"EffectMaterial",defines:{THREE_REVISION:Ne.replace(/\D+/g,""),DEPTH_PACKING:"0",ENCODE_OUTPUT:"1"},uniforms:{inputBuffer:new m(null),depthBuffer:new m(null),resolution:new m(new w),texelSize:new m(new w),cameraNear:new m(.3),cameraFar:new m(1e3),aspect:new m(1),time:new m(0)},blending:W,toneMapped:!1,depthWrite:!1,depthTest:!1,dithering:o}),e&&this.setShaderParts(e),t&&this.setDefines(t),r&&this.setUniforms(r),this.copyCameraSettings(s)}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(e){this.uniforms.depthBuffer.value=e}get depthPacking(){return Number(this.defines.DEPTH_PACKING)}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e,t=re){this.depthBuffer=e,this.depthPacking=t}setShaderData(e){this.setShaderParts(e.shaderParts),this.setDefines(e.defines),this.setUniforms(e.uniforms),this.setExtensions(e.extensions)}setShaderParts(e){return this.fragmentShader=Gs.replace(x.FRAGMENT_HEAD,e.get(x.FRAGMENT_HEAD)||"").replace(x.FRAGMENT_MAIN_UV,e.get(x.FRAGMENT_MAIN_UV)||"").replace(x.FRAGMENT_MAIN_IMAGE,e.get(x.FRAGMENT_MAIN_IMAGE)||""),this.vertexShader=Vs.replace(x.VERTEX_HEAD,e.get(x.VERTEX_HEAD)||"").replace(x.VERTEX_MAIN_SUPPORT,e.get(x.VERTEX_MAIN_SUPPORT)||""),this.needsUpdate=!0,this}setDefines(e){for(const t of e.entries())this.defines[t[0]]=t[1];return this.needsUpdate=!0,this}setUniforms(e){for(const t of e.entries())this.uniforms[t[0]]=t[1];return this}setExtensions(e){this.extensions={};for(const t of e)this.extensions[t]=!0;return this}get encodeOutput(){return this.defines.ENCODE_OUTPUT!==void 0}set encodeOutput(e){this.encodeOutput!==e&&(e?this.defines.ENCODE_OUTPUT="1":delete this.defines.ENCODE_OUTPUT,this.needsUpdate=!0)}isOutputEncodingEnabled(e){return this.encodeOutput}setOutputEncodingEnabled(e){this.encodeOutput=e}get time(){return this.uniforms.time.value}set time(e){this.uniforms.time.value=e}setDeltaTime(e){this.uniforms.time.value+=e}adoptCameraSettings(e){this.copyCameraSettings(e)}copyCameraSettings(e){e&&(this.uniforms.cameraNear.value=e.near,this.uniforms.cameraFar.value=e.far,e instanceof Bt?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}setSize(e,t){const r=this.uniforms;r.resolution.value.set(e,t),r.texelSize.value.set(1/e,1/t),r.aspect.value=e/t}static get Section(){return x}};function Qe(e,t,r){for(const s of t){const o="$1"+e+s.charAt(0).toUpperCase()+s.slice(1),n=new RegExp("([^\\.])(\\b"+s+"\\b)","g");for(const i of r.entries())i[1]!==null&&r.set(i[0],i[1].replace(n,o))}}function $s(e,t,r){let s=t.getFragmentShader(),o=t.getVertexShader();const n=s!==void 0&&/mainImage/.test(s),i=s!==void 0&&/mainUv/.test(s);if(r.attributes|=t.getAttributes(),s===void 0)throw new Error(`Missing fragment shader (${t.name})`);if(i&&(r.attributes&z.CONVOLUTION)!==0)throw new Error(`Effects that transform UVs are incompatible with convolution effects (${t.name})`);if(!n&&!i)throw new Error(`Could not find mainImage or mainUv function (${t.name})`);{const l=/\w+\s+(\w+)\([\w\s,]*\)\s*{/g,c=r.shaderParts;let u=c.get(x.FRAGMENT_HEAD)||"",d=c.get(x.FRAGMENT_MAIN_UV)||"",f=c.get(x.FRAGMENT_MAIN_IMAGE)||"",v=c.get(x.VERTEX_HEAD)||"",p=c.get(x.VERTEX_MAIN_SUPPORT)||"";const S=new Set,R=new Set;if(i&&(d+=`	${e}MainUv(UV);
`,r.uvTransformation=!0),o!==null&&/mainSupport/.test(o)){const T=/mainSupport *\([\w\s]*?uv\s*?\)/.test(o);p+=`	${e}MainSupport(`,p+=T?`vUv);
`:`);
`;for(const b of o.matchAll(/(?:varying\s+\w+\s+([\S\s]*?);)/g))for(const L of b[1].split(/\s*,\s*/))r.varyings.add(L),S.add(L),R.add(L);for(const b of o.matchAll(l))R.add(b[1])}for(const T of s.matchAll(l))R.add(T[1]);for(const T of t.defines.keys())R.add(T.replace(/\([\w\s,]*\)/g,""));for(const T of t.uniforms.keys())R.add(T);R.delete("while"),R.delete("for"),R.delete("if"),t.uniforms.forEach((T,b)=>r.uniforms.set(e+b.charAt(0).toUpperCase()+b.slice(1),T)),t.defines.forEach((T,b)=>r.defines.set(e+b.charAt(0).toUpperCase()+b.slice(1),T));const I=new Map([["fragment",s],["vertex",o]]);Qe(e,R,r.defines),Qe(e,R,I),s=I.get("fragment"),o=I.get("vertex");const N=t.blendMode;if(r.blendModes.set(N.blendFunction,N),n){t.inputColorSpace!==null&&t.inputColorSpace!==r.colorSpace&&(f+=t.inputColorSpace===E?`color0 = sRGBTransferOETF(color0);
	`:`color0 = sRGBToLinear(color0);
	`),t.outputColorSpace!==nt?r.colorSpace=t.outputColorSpace:t.inputColorSpace!==null&&(r.colorSpace=t.inputColorSpace);const T=/MainImage *\([\w\s,]*?depth[\w\s,]*?\)/;f+=`${e}MainImage(color0, UV, `,(r.attributes&z.DEPTH)!==0&&T.test(s)&&(f+="depth, ",r.readDepth=!0),f+=`color1);
	`;const b=e+"BlendOpacity";r.uniforms.set(b,N.opacity),f+=`color0 = blend${N.blendFunction}(color0, color1, ${b});

	`,u+=`uniform float ${b};

`}if(u+=s+`
`,o!==null&&(v+=o+`
`),c.set(x.FRAGMENT_HEAD,u),c.set(x.FRAGMENT_MAIN_UV,d),c.set(x.FRAGMENT_MAIN_IMAGE,f),c.set(x.VERTEX_HEAD,v),c.set(x.VERTEX_MAIN_SUPPORT,p),t.extensions!==null)for(const T of t.extensions)r.extensions.add(T)}}var qs=class extends _{constructor(e,...t){super("EffectPass"),this.fullscreenMaterial=new Ws(null,null,null,e),this.listener=r=>this.handleEvent(r),this.effects=[],this.setEffects(t),this.skipRendering=!1,this.minTime=1,this.maxTime=Number.POSITIVE_INFINITY,this.timeScale=1}set mainScene(e){for(const t of this.effects)t.mainScene=e}set mainCamera(e){this.fullscreenMaterial.copyCameraSettings(e);for(const t of this.effects)t.mainCamera=e}get encodeOutput(){return this.fullscreenMaterial.encodeOutput}set encodeOutput(e){this.fullscreenMaterial.encodeOutput=e}get dithering(){return this.fullscreenMaterial.dithering}set dithering(e){const t=this.fullscreenMaterial;t.dithering=e,t.needsUpdate=!0}setEffects(e){for(const t of this.effects)t.removeEventListener("change",this.listener);this.effects=e.sort((t,r)=>r.attributes-t.attributes);for(const t of this.effects)t.addEventListener("change",this.listener)}updateMaterial(){const e=new Ir;let t=0;for(const i of this.effects)if(i.blendMode.blendFunction===g.DST)e.attributes|=i.getAttributes()&z.DEPTH;else{if((e.attributes&i.getAttributes()&z.CONVOLUTION)!==0)throw new Error(`Convolution effects cannot be merged (${i.name})`);$s("e"+t++,i,e)}let r=e.shaderParts.get(x.FRAGMENT_HEAD),s=e.shaderParts.get(x.FRAGMENT_MAIN_IMAGE),o=e.shaderParts.get(x.FRAGMENT_MAIN_UV);const n=/\bblend\b/g;for(const i of e.blendModes.values())r+=i.getShaderCode().replace(n,`blend${i.blendFunction}`)+`
`;(e.attributes&z.DEPTH)!==0?(e.readDepth&&(s=`float depth = readDepth(UV);

	`+s),this.needsDepthTexture=this.getDepthTexture()===null):this.needsDepthTexture=!1,e.colorSpace===E&&(s+=`color0 = sRGBToLinear(color0);
	`),e.uvTransformation?(o=`vec2 transformedUv = vUv;
`+o,e.defines.set("UV","transformedUv")):e.defines.set("UV","vUv"),e.shaderParts.set(x.FRAGMENT_HEAD,r),e.shaderParts.set(x.FRAGMENT_MAIN_IMAGE,s),e.shaderParts.set(x.FRAGMENT_MAIN_UV,o);for(const[i,l]of e.shaderParts)l!==null&&e.shaderParts.set(i,l.trim().replace(/^#/,`
#`));this.skipRendering=t===0,this.needsSwap=!this.skipRendering,this.fullscreenMaterial.setShaderData(e)}recompile(){this.updateMaterial()}getDepthTexture(){return this.fullscreenMaterial.depthBuffer}setDepthTexture(e,t=re){this.fullscreenMaterial.depthBuffer=e,this.fullscreenMaterial.depthPacking=t;for(const r of this.effects)r.setDepthTexture(e,t)}render(e,t,r,s,o){for(const n of this.effects)n.update(e,t,s);if(!this.skipRendering||this.renderToScreen){const n=this.fullscreenMaterial;n.inputBuffer=t.texture,n.time+=s*this.timeScale,e.setRenderTarget(this.renderToScreen?null:r),e.render(this.scene,this.camera)}}setSize(e,t){this.fullscreenMaterial.setSize(e,t);for(const r of this.effects)r.setSize(e,t)}initialize(e,t,r){this.renderer=e;for(const s of this.effects)s.initialize(e,t,r);this.updateMaterial(),r!==void 0&&r!==K&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}dispose(){super.dispose();for(const e of this.effects)e.removeEventListener("change",this.listener),e.dispose()}handleEvent(e){switch(e.type){case"change":this.recompile();break}}},Xs=class extends _{constructor(e,t,{renderTarget:r,resolutionScale:s=1,width:o=A.AUTO_SIZE,height:n=A.AUTO_SIZE,resolutionX:i=o,resolutionY:l=n}={}){super("NormalPass"),this.needsSwap=!1,this.renderPass=new bt(e,t,new Ct);const c=this.renderPass;c.ignoreBackground=!0,c.skipShadowMapUpdate=!0;const u=c.getClearPass();u.overrideClearColor=new ee(7829503),u.overrideClearAlpha=1,this.renderTarget=r,this.renderTarget===void 0&&(this.renderTarget=new D(1,1,{minFilter:te,magFilter:te}),this.renderTarget.texture.name="NormalPass.Target");const d=this.resolution=new A(this,i,l,s);d.addEventListener("change",f=>this.setSize(d.baseWidth,d.baseHeight))}set mainScene(e){this.renderPass.mainScene=e}set mainCamera(e){this.renderPass.mainCamera=e}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}render(e,t,r,s,o){const n=this.renderToScreen?null:this.renderTarget;this.renderPass.render(e,n,n)}setSize(e,t){const r=this.resolution;r.setBaseSize(e,t),this.renderTarget.setSize(r.width,r.height)}};const Ks=h.createContext(null),Je=e=>(e.getAttributes()&z.CONVOLUTION)===z.CONVOLUTION,Ys=O.memo(h.forwardRef(({children:e,camera:t,scene:r,resolutionScale:s,enabled:o=!0,renderPriority:n=1,autoClear:i=!0,depthBuffer:l,enableNormalPass:c,stencilBuffer:u,multisampling:d=8,frameBufferType:f=jt},v)=>{const{gl:p,scene:S,camera:R,size:I}=de(),N=r||S,T=t||R,[b,L,q]=h.useMemo(()=>{const F=kt(),U=new Pr(p,{depthBuffer:l,stencilBuffer:u,multisampling:d>0&&F?d:0,frameBufferType:f});U.addPass(new bt(N,T));let C=null,k=null;return c&&(k=new Xs(N,T),k.enabled=!1,U.addPass(k),s!==void 0&&F&&(C=new Os({normalBuffer:k.texture,resolutionScale:s}),C.enabled=!1,U.addPass(C))),[U,k,C]},[T,p,l,u,d,f,N,c,s]);h.useEffect(()=>b?.setSize(I.width,I.height),[b,I]),Pe((F,U)=>{if(o){const C=p.autoClear;p.autoClear=i,u&&!i&&p.clearStencil(),b.render(U),p.autoClear=C}},o?n:0);const he=h.useRef(null),fe=zt(he);h.useLayoutEffect(()=>{const F=[];if(he.current&&fe.current&&b){const U=fe.current.objects;for(let C=0;C<U.length;C++){const k=U[C];if(k instanceof Y){const ke=[k];if(!Je(k)){let pe=null;for(;(pe=U[C+1])instanceof Y&&!Je(pe);)ke.push(pe),C++}const Et=new qs(T,...ke);F.push(Et)}else k instanceof _&&F.push(k)}for(const C of F)b?.addPass(C);L&&(L.enabled=!0),q&&(q.enabled=!0)}return()=>{for(const U of F)b?.removePass(U);L&&(L.enabled=!1),q&&(q.enabled=!1)}},[b,e,T,L,q,fe]),h.useEffect(()=>{const F=p.toneMapping;return p.toneMapping=Ht,()=>{p.toneMapping=F}},[]);const wt=h.useMemo(()=>({composer:b,normalPass:L,downSamplingPass:q,resolutionScale:s,camera:T,scene:N}),[b,L,q,s,T,N]);return h.useImperativeHandle(v,()=>b,[b]),a.jsx(Ks.Provider,{value:wt,children:a.jsx("group",{ref:he,children:e})})}));let Zs=0;const et=new WeakMap,De=(e,t)=>O.forwardRef(function({blendFunction:s=t?.blendFunction,opacity:o=t?.opacity,...n},i){let l=et.get(e);if(!l){const d=`@react-three/postprocessing/${e.name}-${Zs++}`;Ft({[d]:e}),et.set(e,l=d)}const c=de(d=>d.camera),u=O.useMemo(()=>{var d,f;return[...(d=t?.args)!=null?d:[],...(f=n.args)!=null?f:[{...t,...n}]]},[JSON.stringify(n)]);return a.jsx(l,{camera:c,"blendMode-blendFunction":s,"blendMode-opacity-value":o,...n,ref:i,args:u})}),Qs=De(Rs,{blendFunction:g.ADD}),Js=De(Ns),ei=h.forwardRef(function({blendFunction:t,adaptive:r,mode:s,resolution:o,maxLuminance:n,whitePoint:i,middleGrey:l,minLuminance:c,averageLuminance:u,adaptationRate:d,...f},v){const p=h.useMemo(()=>new zs({blendFunction:t,adaptive:r,mode:s,resolution:o,maxLuminance:n,whitePoint:i,middleGrey:l,minLuminance:c,averageLuminance:u,adaptationRate:d}),[t,r,s,o,n,i,l,c,u,d]);return h.useEffect(()=>{p.dispose()},[p]),a.jsx("primitive",{...f,ref:v,object:p,attributes:z.CONVOLUTION})}),ti=De(Fs);class ri extends h.Component{constructor(t){super(t),this.state={hasError:!1}}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(t){console.log("[CinematicEffects] Bloom  :",t.message)}render(){return this.state.hasError?null:this.props.children}}const si=()=>a.jsx(ri,{children:a.jsxs(Ys,{disableNormalPass:!0,children:[a.jsx(Qs,{luminanceThreshold:.5,mipmapBlur:!0,intensity:.4,radius:.6,levels:8}),a.jsx(Js,{offset:[.001,.001],radialModulation:!1,modulationOffset:0}),a.jsx(ti,{offset:.4,darkness:.5,eskil:!1}),a.jsx(ei,{adaptive:!0,resolution:256,middleGrey:.6,maxLuminance:16,averageLuminance:1,adaptationRate:1})]})}),y=Gt(e=>({currentScene:"boot",prevScene:null,isTransitioning:!1,performanceMode:"high",isMuted:!1,systemLogs:[],addLog:t=>e(r=>({systemLogs:[{timestamp:new Date().toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"}),message:t},...r.systemLogs].slice(0,100)})),setHoverState:t=>e({hoverState:t}),isWarping:!1,warpTarget:null,warpTargetPosition:null,startWarp:(t,r=null)=>e({isWarping:!0,warpTarget:t,warpTargetPosition:r}),finishWarp:()=>e(t=>({prevScene:t.currentScene,currentScene:t.warpTarget,isTransitioning:!0,isWarping:!1,warpTarget:null,warpTargetPosition:null})),setScene:t=>e(r=>r.currentScene===t?{}:{prevScene:r.currentScene,currentScene:t,isTransitioning:!0}),endTransition:()=>e({isTransitioning:!1}),setPerformanceMode:t=>e({performanceMode:t}),toggleMute:()=>e(t=>({isMuted:!t.isMuted})),orbitSpeed:.05,setOrbitSpeed:t=>e({orbitSpeed:t})})),ii=h.lazy(()=>$(()=>import("./BootScene-KBaouhkE.js"),__vite__mapDeps([0,1,2,3]))),ni=h.lazy(()=>$(()=>import("./HubScene-CFlpwmMI.js"),__vite__mapDeps([4,1,2,3]))),ai=h.lazy(()=>$(()=>import("./ProfileScene-C0sxOa8H.js"),__vite__mapDeps([5,1,2,3]))),oi=h.lazy(()=>$(()=>import("./Lab01Scene-B_xSJRnH.js"),__vite__mapDeps([6,1,2,3]))),li=h.lazy(()=>$(()=>import("./Lab02Scene-3cIUYUg3.js"),__vite__mapDeps([7,1,2,3]))),ci=h.lazy(()=>$(()=>import("./Lab03Scene-CEvcj-1X.js"),__vite__mapDeps([8,1,2,3]))),ui=h.lazy(()=>$(()=>import("./Lab04Scene-Cq8ltwvF.js"),__vite__mapDeps([9,1,2,3]))),di=h.lazy(()=>$(()=>import("./ContactScene-CbL8WFCh.js"),__vite__mapDeps([10,1,2,3]))),hi=()=>{const e=y(t=>t.currentScene);return a.jsx(h.Suspense,{fallback:null,children:a.jsxs("group",{children:[e==="boot"&&a.jsx(ii,{}),e==="hub"&&a.jsx(ni,{}),e==="profile"&&a.jsx(ai,{}),e==="lab01"&&a.jsx(oi,{}),e==="contact"&&a.jsx(di,{}),e==="lab02"&&a.jsx(li,{}),e==="lab03"&&a.jsx(ci,{}),e==="lab04"&&a.jsx(ui,{})]})})},tt={uniforms:{uColorInner:{value:new ee("#ffaa00")},uColorOuter:{value:new ee("#00ffff")}},vertexShader:`
        varying vec2 vUv;
        varying vec3 vPosition;
        void main() {
            vUv = uv;
            vPosition = position;
            gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
        }
    `,fragmentShader:`
        uniform float uTime;
        uniform vec3 uColorInner;
        uniform vec3 uColorOuter;
        varying vec2 vUv;
        varying vec3 vPosition;

        // Simple Noise
        float noise(vec2 p) {
            return fract(sin(dot(p, vec2(12.9898, 78.233))) * 43758.5453);
        }

        void main() {
            // Center is (0.5, 0.5)
            vec2 center = vec2(0.5);
            vec2 pos = vUv - center;
            float r = length(pos) * 2.0; // Radius 0 to 1
            float angle = atan(pos.y, pos.x);

            // Black Hole Event Horizon (Center)
            float eventHorizon = smoothstep(0.15, 0.2, r); // Smaller black hole hole
            
            // Accretion Disk Pattern
            // Spiral rotation
            float spiral = angle + 10.0 / (r + 0.1) - uTime * 2.0;
            float diskNoise = noise(vec2(r * 10.0, spiral * 5.0));
            
            // Soft glow
            float glow = 1.0 / (r + 0.1) * 0.1;
            
            // Disk Ring
            float disk = smoothstep(0.2, 0.5, r) * smoothstep(1.0, 0.4, r); // Wider fade out
            
            // Color mixing
            vec3 color = mix(uColorOuter, uColorInner, diskNoise);
            color += glow * uColorOuter;
            
            // Apply patterns
            float intensity = disk * (0.8 + 0.2 * diskNoise) + glow;
            
            // Final masking
            vec3 finalColor = color * intensity * eventHorizon;
            
            // Alpha fade at edges (Ensure scale is large enough so this fade happens off-screen or smooth)
            float alpha = smoothstep(0.0, 0.1, intensity);

            gl_FragColor = vec4(finalColor, alpha);
        }
    `},fi=({isFinished:e})=>{const t=h.useRef();Pe(s=>{const o=s.clock.getElapsedTime();t.current&&(t.current.uniforms.uTime.value=o*2);const n=1+Math.sin(o*3)*.05;t.current&&t.current.parent&&t.current.parent.scale.set(n,n,1)});const r=h.useMemo(()=>new G({uniforms:{uTime:{value:0},uColorInner:{value:new ee("#ffaa00")},uColorOuter:{value:new ee("#00ccff")}},vertexShader:tt.vertexShader,fragmentShader:tt.fragmentShader,transparent:!0,side:ae,depthWrite:!1,blending:Vt}),[]);return a.jsxs("group",{children:[a.jsx(Wt,{radius:100,depth:50,count:5e3,factor:4,saturation:0,fade:!0,speed:3}),a.jsxs("mesh",{rotation:[-Math.PI/3,0,0],scale:[2,2,2],children:[a.jsx("planeGeometry",{args:[50,50]})," ",a.jsx("primitive",{object:r,attach:"material",ref:t})]}),a.jsx("group",{rotation:[-Math.PI/3,0,0],children:a.jsx($t,{count:500,scale:[20,20,5],size:4,speed:2,opacity:.6,color:"#ffaa00"})}),a.jsxs("mesh",{position:[0,0,.1],children:[a.jsx("sphereGeometry",{args:[2,64,64]}),a.jsx("meshBasicMaterial",{color:"#000000"})]})]})},pn=Object.freeze(Object.defineProperty({__proto__:null,default:fi},Symbol.toStringTag,{value:"Module"})),Le={},mn=(e,t)=>{Le[e]=t},vn=e=>{delete Le[e]},pi=(e,t)=>{const r=Le[e];return r&&r.current?(r.current.getWorldPosition(t),t):null},mi=()=>{const{camera:e,controls:t}=de(),r=y(l=>l.isWarping),s=y(l=>l.warpTargetPosition),o=y(l=>l.warpTarget),n=y(l=>l.finishWarp),i=h.useRef(new X);return h.useEffect(()=>{if(r&&s){t&&(t.enabled=!1);const l=new X(...s),c=we.timeline({onComplete:()=>{n(),t&&(t.enabled=!0)}});return c.to(e.position,{x:l.x*.8,y:l.y*.8,z:l.z*.8,duration:2.5,ease:"power2.in"}),()=>{c.kill(),t&&(t.enabled=!0)}}},[r,e,n,s,t]),Pe(()=>{r&&o&&pi(o,i.current)&&e.lookAt(i.current)},100),null},vi=()=>{const e=y(i=>i.currentScene),t=y(i=>i.prevScene),r=y(i=>i.isWarping),{camera:s,gl:o,controls:n}=de();return h.useEffect(()=>{if(r){console.log("[CameraHandler] Warping active, skipping reset.");return}if(we.killTweensOf(s.position),e==="hub"){const i=new X(0,5,32),l={lab01:new X(4,2,10),lab02:new X(6,3,13),lab03:new X(8,4,16),lab04:new X(10,5,19)};t&&l[t]?(s.position.copy(l[t]),s.lookAt(0,0,0),we.to(s.position,{x:i.x,y:i.y,z:i.z,duration:3.5,ease:"power2.out",onUpdate:()=>s.lookAt(0,0,0)})):s.position.copy(i)}else e==="boot"?s.position.set(0,0,12):e.startsWith("lab")?s.position.set(0,0,14):e==="contact"?s.position.set(0,0,12):s.position.set(0,0,5);n&&(n.target.set(0,0,0),n.update()),(e!=="hub"||!t)&&s.lookAt(0,0,0),s.updateProjectionMatrix()},[e,t,s,o,n,r]),null},gi=()=>{const e=y(r=>r.currentScene),t=y(r=>r.isWarping);return a.jsx("div",{className:"w-full h-screen fixed inset-0 z-0 bg-black",children:a.jsxs(qt,{dpr:[1,2],gl:{antialias:!0,powerPreference:"high-performance",preserveDrawingBuffer:!0},children:[a.jsx(vi,{}),a.jsx(Xt,{makeDefault:!0,position:[0,0,18]}),a.jsx(Kt,{makeDefault:!0,minPolarAngle:0,maxPolarAngle:Math.PI-.1,minDistance:2,maxDistance:30,enablePan:!1,enableDamping:!0,dampingFactor:.05,rotateSpeed:.5,enabled:e!=="profile"&&e!=="contact"&&!t}),a.jsx("color",{attach:"background",args:["#000000"]}),a.jsx("ambientLight",{intensity:1}),a.jsx(hi,{}),a.jsx(mi,{}),a.jsx(si,{})]})})},xi=[{version:"v1.5.0",date:"2025-12-19",title:"FINAL POLISH & UX REFINEMENT",changes:["Implemented User Interaction requirement for Audio Autoplay","Added 'Planning Philosophy' section to Profile","Refined Navbar naming to match Content (Assignments -> Awards)","Optimized Boot Log visualization","Fixed History update synchronization"]},{version:"v1.4.0",date:"2025-12-19",title:"MULTIVERSE LABS EXPANSION",changes:["Implemented 3 Distinct Lab Concepts (Organic, Audio, Glitch)","Populated 'Work' universe with actual project data","Added dynamic Tech Stack visualization in Lab 02","Enhanced Audio Visualizer in Lab 03 with pulsating core","Created 'Glitch Moon' environment for Lab 04"]},{version:"v1.3.0",date:"2025-12-18",title:"CONTENT SYNCHRONIZATION",changes:["Updated Hero/Career/Achievements with actual award data","Integrated 2024 ICT Awards (Grand Prize) & Web Award Korea records","Fixed Korean text encoding issues across all sections","Re-encoded Profile sections to UTF-8","Created content archive from Gamma portfolio"]},{version:"v1.2.5",date:"2025-12-16",title:"CINEMATIC FX UPGRADE",changes:["Restored Cinematic Bloom post-processing effect","Added procedural Sound FX (Hover/Click) via Web Audio API","Lab03 visual overhaul: Particle Cloud + Wireframe Wave","Fixed Lab03/Lab04 routing swap","Deployed to heoyesol.kr custom domain"]},{version:"v1.2.0",date:"2025-12-12",title:"COSMIC UPDATE",changes:["Implemented Atomic Orbital Physics for Hub Scene","Added 3D Electron Cloud aesthetics","Enhanced camera stabilization system","Integrated Matrix Rain effect in Boot Sequence","Optimized performance with Delta-Time based animations"]},{version:"v1.1.5",date:"2025-12-11",title:"VISUAL OVERHAUL",changes:["Resolved WebGL Crash issues","Upgraded post-processing pipeline","Added custom cursor with interactive states","Implemented sound effects engine (Hover/Click)","Deployed to custom domain (heoyesol.kr)"]},{version:"v1.0.0",date:"2025-12-01",title:"SYSTEM INITIALIZATION",changes:["Initial Release","Core systems online","Lab01-04 modules loaded","Boot sequence established"]}],yi=[{version:"Recent Dev Stream",date:"2025-12-19",title:"DEVELOPER LOG (LIVE)",changes:[" : (hub): Restore dynamic camera focus during warp and cleanup syntax"," : (hub):  warp  race condition and syntax checks"," : (hub):  warp visuals &  Identity  interaction"," : (hub):  critical  on planet interaction (Vector3 mismatch)","  : Hub UI Enhancements (Identity Label, Planet Interactions)"," :  UI,   filename,   "," :   ( to Start),  History Data, Expand  ","  :   , 2D Boots, Navbar , and   "," : Push latest build  for ment (DPR/Mobile )"," : Enforce gitignore to   "]}],rt=[...yi,...xi],bi=({onClose:e})=>{const[t,r]=h.useState("PATCH"),s=y(o=>o.systemLogs);return a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm p-4 pointer-events-auto",children:a.jsxs("div",{className:"w-full max-w-2xl h-[70vh] bg-black border border-[#00ff41] p-6 font-mono text-[#00ff41] shadow-[0_0_20px_rgba(0,255,65,0.2)] relative overflow-hidden flex flex-col",children:[a.jsx("div",{className:"absolute inset-0 bg-[linear-gradient(transparent_50%,rgba(0,255,65,0.05)_50%)] bg-[length:100%_4px] pointer-events-none z-0"}),a.jsxs("div",{className:"flex justify-between items-start mb-6 border-b border-[#00ff41]/30 pb-4 z-10 relative",children:[a.jsx("div",{className:"flex flex-col gap-2",children:a.jsxs("div",{className:"flex gap-4",children:[a.jsx("button",{onClick:()=>r("PATCH"),className:`text-lg font-bold transition-all ${t==="PATCH"?"text-white text-shadow-glow underline decoration-2 underline-offset-4":"opacity-50 hover:opacity-100"}`,children:"UPDATE_LOGS"}),a.jsx("button",{onClick:()=>r("SYSTEM"),className:`text-lg font-bold transition-all ${t==="SYSTEM"?"text-white text-shadow-glow underline decoration-2 underline-offset-4":"opacity-50 hover:opacity-100"}`,children:"SYSTEM_LOGS"})]})}),a.jsx("button",{onClick:e,className:"hover:bg-[#00ff41] hover:text-black px-2 py-1 transition-colors border border-[#00ff41]/50 text-xs",children:"[CLOSE_TERMINAL]"})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar z-10 relative pr-2",children:[t==="PATCH"&&a.jsx("div",{className:"space-y-8",children:rt.map((o,n)=>a.jsxs("div",{className:"border-l-2 border-[#00ff41]/50 pl-4 relative",children:[a.jsx("div",{className:"absolute -left-[5px] top-0 w-2 h-2 bg-[#00ff41]"}),a.jsxs("div",{className:"flex justify-between items-baseline mb-2 text-sm opacity-70",children:[a.jsx("span",{children:o.date}),a.jsx("span",{children:o.version})]}),a.jsx("h3",{className:"text-lg font-bold mb-3 text-white",children:o.title}),a.jsx("ul",{className:"space-y-1 text-sm text-[#00ff41]/80",children:o.changes.map((i,l)=>a.jsxs("li",{className:"flex",children:[a.jsx("span",{className:"mr-2",children:">"}),i]},l))})]},n))}),t==="SYSTEM"&&a.jsxs("div",{className:"font-mono text-xs space-y-1",children:[s.length===0&&a.jsx("div",{className:"text-center opacity-50 py-10",children:"NO_SYSTEM_LOGS_FOUND_LOCAL_MEMORY_EMPTY"}),s.map((o,n)=>a.jsxs("div",{className:"flex gap-4 hover:bg-[#00ff41]/10 px-2 py-0.5 rounded transition-colors",children:[a.jsx("span",{className:"opacity-50 min-w-[80px]",children:o.timestamp}),a.jsx("span",{className:`${o.message.includes("FATAL")||o.message.includes("ERROR")?"text-red-500 font-bold":o.message.includes("OK")?"text-white":"text-[#00ff41]/80"}`,children:o.message})]},n))]})]}),a.jsxs("div",{className:"mt-4 text-[10px] text-center opacity-50 border-t border-[#00ff41]/30 pt-4 z-10",children:["STATUS: ",t==="PATCH"?"ONLINE":"MONITORING"," // RECORDS: ",t==="PATCH"?rt.length:s.length," // MEM_USAGE: ",Math.floor(Math.random()*30+10),"MB"]})]})})},Ti=()=>{const[e,t]=h.useState(!1),[r,s]=h.useState(!1);h.useEffect(()=>{const d=()=>{s(window.scrollY>50)};return window.addEventListener("scroll",d),()=>window.removeEventListener("scroll",d)},[]);const[o,n]=h.useState("");h.useEffect(()=>{const d=()=>{const f=["hero","about","work","expertise","achievements"],v=window.scrollY+100;for(const p of f){const S=document.getElementById(p);if(S&&S.offsetTop<=v&&S.offsetTop+S.offsetHeight>v){n(p==="achievements"?"awards":p),n(p);return}}n("")};return window.addEventListener("scroll",d),()=>window.removeEventListener("scroll",d)},[]);const i=y(d=>d.currentScene),l=y(d=>d.setScene),c=(d,f)=>{l(d),f&&setTimeout(()=>{const v=document.getElementById(f);v&&v.scrollIntoView({behavior:"smooth"})},100)},u=[{name:"Home",action:()=>c("hub"),id:"hub"},{name:"About",action:()=>c("profile","about"),id:"about"},{name:"Experience",action:()=>c("profile","work"),id:"work"},{name:"Expertise",action:()=>c("profile","expertise"),id:"expertise"},{name:"Awards",action:()=>c("profile","achievements"),id:"achievements"},{name:"Contact",action:()=>c("contact"),id:"contact"},{name:"History",action:()=>l("history"),id:"history"}];return a.jsxs("nav",{className:`fixed w-full z-50 transition-all duration-300 pointer-events-none bg-black/60 backdrop-blur-md border-b border-white/10 ${r?"py-3":"py-4"}`,children:[a.jsxs("div",{className:"container mx-auto px-6 flex justify-between items-center",children:[a.jsx("button",{onClick:()=>l("hub"),className:"text-2xl font-bold bg-gradient-to-r from-primary to-accent bg-clip-text text-transparent pointer-events-auto",children:"Yesol Heo"}),a.jsx("div",{className:"hidden md:flex space-x-8 pointer-events-auto",children:u.map(d=>a.jsx("button",{onClick:d.action,className:`transition-colors text-sm font-medium ${i==="history"&&d.name==="History"?"text-primary font-bold":o===d.id?"text-primary font-bold shadow-[0_0_10px_rgba(6,182,212,0.5)]":"text-gray-300 hover:text-white hover:text-glow"}`,children:d.name},d.name))}),a.jsx("button",{className:"md:hidden text-white pointer-events-auto p-2",onClick:()=>t(!e),children:e?a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]}):a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("line",{x1:"3",y1:"12",x2:"21",y2:"12"}),a.jsx("line",{x1:"3",y1:"6",x2:"21",y2:"6"}),a.jsx("line",{x1:"3",y1:"18",x2:"21",y2:"18"})]})})]}),a.jsx(Zt,{children:e&&a.jsx(M.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"md:hidden bg-surface border-b border-gray-800 bg-black/90 backdrop-blur",children:a.jsx("div",{className:"flex flex-col px-6 py-4 space-y-4",children:u.map(d=>a.jsx("button",{className:"text-gray-300 hover:text-white block py-3 text-left",onClick:()=>{d.action(),t(!1)},children:d.name},d.name))})})})]})},Si=()=>{const e=y(n=>n.currentScene),t=y(n=>n.setScene),r=y(n=>n.isMuted),s=y(n=>n.toggleMute),o=y(n=>n.performanceMode);return y(n=>n.orbitSpeed),y(n=>n.setOrbitSpeed),a.jsxs("div",{className:"fixed inset-0 pointer-events-none z-40 text-xs font-mono select-none",children:[e==="history"&&a.jsx(bi,{onClose:()=>t("hub")}),e!=="boot"&&e!=="hub"&&e!=="history"&&a.jsxs("button",{onClick:()=>t("hub"),className:"fixed top-24 left-6 pointer-events-auto flex items-center gap-2 group text-white/70 hover:text-white transition-colors",children:[a.jsx("span",{className:"w-8 h-px bg-white/30 group-hover:bg-accent transition-colors"}),"< RETURN TO SYSTEM [ESC]"]}),a.jsx(Ti,{}),a.jsxs("div",{className:"fixed top-20 right-6 md:top-24 md:right-10 flex flex-col gap-2 pointer-events-auto z-50 items-end",children:[a.jsxs("button",{onClick:s,className:"px-3 py-1.5 md:px-4 md:py-2 bg-black/50 backdrop-blur-md rounded-full border border-white/10 hover:border-accent text-white transition-colors flex items-center gap-2 justify-between min-w-[110px] md:min-w-[140px]",children:[a.jsx("span",{className:"text-[10px] md:text-xs",children:"AUDIO"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-[10px] text-white/50",children:r?"OFF":"ON"}),a.jsx("div",{className:`w-1.5 h-1.5 md:w-2 md:h-2 rounded-full ${r?"bg-red-500":"bg-green-500 animate-pulse"}`})]})]}),a.jsxs("button",{onClick:()=>{const n=o==="high"?"low":"high";y.getState().setPerformanceMode(n)},className:"px-3 py-1.5 md:px-4 md:py-2 bg-black/50 backdrop-blur-md rounded-full border border-white/10 hover:border-accent text-white transition-colors flex items-center gap-2 justify-between min-w-[110px] md:min-w-[140px]",children:[a.jsx("span",{className:"text-[10px] md:text-xs",children:"PERF"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-[10px] text-white/50",children:o==="high"?"HIGH":"LOW"}),a.jsx("div",{className:`w-1.5 h-1.5 md:w-2 md:h-2 rounded-full ${o==="low"?"bg-yellow-500":"bg-cyan-500 animate-pulse"}`})]})]})]}),a.jsxs("div",{className:"fixed bottom-10 left-10 text-xs text-muted font-mono mix-blend-difference",children:["SYSTEM: ONLINE ",a.jsx("br",{}),"FPS: 60 ",a.jsx("br",{}),"COORD: [34.5, 127.0]"]})]})},wi=()=>{const e=y(c=>c.hoverState),[t,r]=h.useState({x:0,y:0}),[s,o]=h.useState(!1),[n,i]=h.useState(!1),l=s||e;return h.useEffect(()=>{const c=d=>{r({x:d.clientX,y:d.clientY}),n||i(!0)};window.addEventListener("mousemove",c);const u=d=>{d.target.tagName==="A"||d.target.tagName==="BUTTON"||d.target.closest("a")||d.target.closest("button")?o(!0):o(!1)};return window.addEventListener("mouseover",u),()=>{window.removeEventListener("mousemove",c),window.removeEventListener("mouseover",u)}},[n]),n?a.jsx(M.div,{className:"fixed top-0 left-0 pointer-events-none z-[9999] hidden md:flex items-center justify-center mix-blend-difference",animate:{x:t.x,y:t.y,translateX:"-50%",translateY:"-50%",width:l?48:32,height:l?48:32,backgroundColor:l?"rgba(6, 182, 212, 0.1)":"rgba(0, 0, 0, 0)",borderColor:l?"#06b6d4":"#e5e5e5",borderRadius:l?"8px":"50%"},style:{borderWidth:"1px",borderStyle:"solid"},transition:{type:"spring",stiffness:500,damping:28,mass:.5},children:a.jsx(M.div,{className:"w-1 h-1 bg-white rounded-full",animate:{scale:l?0:1,opacity:l?0:1}})}):null},Ei=()=>{const e=y(i=>i.currentScene),t=y(i=>i.isMuted),r=h.useRef(null),s=h.useRef(null),o={boot:"/sounds/hub_theme.mp3",hub:"/sounds/hub_theme.mp3",profile:"/sounds/hub_theme.mp3",lab01:"/sounds/lab01_theme.mp3",lab02:"/sounds/lab02_theme.mp3",lab03:"/sounds/lab03_theme.mp3",lab04:"/sounds/lab04_theme.mp3",contact:"/sounds/hub_theme.mp3"},n=async i=>{let l=o[i]||o.hub;if(i.startsWith("lab01")?l=o.lab01:i.startsWith("lab02")?l=o.lab02:i.startsWith("lab03")?l=o.lab03:i.startsWith("lab04")&&(l=o.lab04),s.current===l)return;r.current&&r.current.pause(),s.current=l;const c=new Audio(l);c.loop=!0,c.volume=t?0:.4;try{await c.play(),r.current=c}catch(u){console.warn("Audio Autoplay blocked, waiting for interaction",u)}};return h.useEffect(()=>{n(e)},[e]),h.useEffect(()=>{r.current&&(r.current.volume=t?0:.4,!t&&r.current.paused&&r.current.play().catch(i=>console.warn("Play failed",i)))},[t]),h.useEffect(()=>{const i=()=>{r.current&&r.current.paused&&!t&&r.current.play().catch(l=>console.log("Audio resume failed",l))};return window.addEventListener("click",i),()=>window.removeEventListener("click",i)},[t]),null},Mi=()=>{const e=y(t=>t.setScene);return a.jsx("section",{className:"min-h-screen flex items-center justify-center relative z-10 pointer-events-none pt-20",children:a.jsx("div",{className:"container mx-auto px-6 text-center pointer-events-auto",children:a.jsxs(M.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8},children:[a.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-white/5 border border-cyan-500/30 rounded-full mb-6",children:[a.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),a.jsx("span",{className:"text-xs text-cyan-400 font-mono",children:"5 PM   CTS"})]}),a.jsx("h2",{className:"text-xl md:text-2xl font-mono text-cyan-400 mb-4 tracking-widest",children:", "}),a.jsxs("h1",{className:"text-4xl md:text-6xl font-bold text-white mb-6 leading-tight",children:["Metaverse & XR ",a.jsx("br",{}),a.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 via-purple-500 to-pink-500",children:"Project Manager"})]}),a.jsxs("p",{className:"text-gray-400 text-lg md:text-xl max-w-2xl mx-auto mb-8 leading-relaxed",children:[", XR,        .",a.jsx("br",{}),"  UI/UX      ."]}),a.jsxs("div",{className:"flex flex-wrap justify-center gap-3 mb-10",children:[a.jsx("span",{className:"px-3 py-1 bg-yellow-500/10 border border-yellow-500/30 rounded-full text-xs text-yellow-400 font-mono",children:" 2024 ICT Award Grand Prize"}),a.jsx("span",{className:"px-3 py-1 bg-purple-500/10 border border-purple-500/30 rounded-full text-xs text-purple-400 font-mono",children:" 2024  "})]}),a.jsxs("div",{className:"flex flex-wrap justify-center gap-4",children:[a.jsx("button",{onClick:()=>document.getElementById("work")?.scrollIntoView({behavior:"smooth"}),className:"px-8 py-3 bg-white text-black font-bold rounded-full hover:bg-gray-200 transition-all transform hover:scale-105",children:" "}),a.jsx("button",{onClick:()=>e("contact"),className:"px-8 py-3 border border-white/30 text-white font-bold rounded-full hover:bg-white/10 transition-all backdrop-blur-sm",children:""})]})]})})})},Ai=()=>a.jsx("section",{className:"py-20 relative z-10 text-white",children:a.jsxs("div",{className:"container mx-auto px-6 max-w-4xl",children:[a.jsxs(M.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},className:"text-center mb-16",children:[a.jsx("h2",{className:"text-sm font-mono text-cyan-400 mb-2 tracking-widest",children:"ABOUT ME"}),a.jsxs("h3",{className:"text-3xl md:text-4xl font-bold leading-tight",children:["   ",a.jsx("br",{}),a.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 to-purple-500",children:"  PM"})]})]}),a.jsxs("div",{className:"grid md:grid-cols-2 gap-12 text-gray-300 leading-relaxed text-lg",children:[a.jsxs(M.div,{initial:{opacity:0,x:-20},whileInView:{opacity:1,x:0},viewport:{once:!0},transition:{delay:.2},children:[a.jsxs("h4",{className:"text-white font-bold text-xl mb-4 flex items-center gap-2",children:[a.jsx("span",{className:"w-2 h-2 bg-cyan-500 rounded-full"}),"  "]}),a.jsx("p",{className:"mb-6",children:"       ,         ."}),a.jsx("p",{children:"  , ,            ."})]}),a.jsxs(M.div,{initial:{opacity:0,x:20},whileInView:{opacity:1,x:0},viewport:{once:!0},transition:{delay:.4},children:[a.jsxs("h4",{className:"text-white font-bold text-xl mb-4 flex items-center gap-2",children:[a.jsx("span",{className:"w-2 h-2 bg-purple-500 rounded-full"}),"  "]}),a.jsx("p",{className:"mb-6",children:'"    "  ,       .'}),a.jsx("p",{children:"          ,       ."})]})]}),a.jsxs(M.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{delay:.6},className:"mt-16 p-8 bg-white/5 border border-white/10 rounded-2xl text-center backdrop-blur-sm",children:[a.jsx("p",{className:"text-xl font-medium text-white mb-2",children:'"      ,"'}),a.jsx("p",{className:"text-cyan-400",children:"      ."}),a.jsxs(M.div,{initial:{opacity:0,x:20},whileInView:{opacity:1,x:0},viewport:{once:!0},transition:{delay:.2},className:"mt-8 bg-white/5 p-8 rounded-2xl border border-white/10 backdrop-blur-sm text-left",children:[a.jsxs("h4",{className:"text-white font-bold text-xl mb-4 flex items-center gap-2",children:[a.jsx("span",{className:"w-2 h-2 bg-purple-500 rounded-full"}),"Multiverse Architect:  "]}),a.jsx("p",{className:"mb-6 leading-relaxed",children:"     , **  (Universe)**  .  ,        (Project) ,        ."}),a.jsx("p",{className:"text-gray-300 leading-relaxed",children:"       , **[Boot - Hub - Lab]**     .             .     **  **,   ."})]})]})]})});const Ri=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),_i=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,s)=>s?s.toUpperCase():r.toLowerCase()),st=e=>{const t=_i(e);return t.charAt(0).toUpperCase()+t.slice(1)},Tt=(...e)=>e.filter((t,r,s)=>!!t&&t.trim()!==""&&s.indexOf(t)===r).join(" ").trim(),Ci=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};var Ni={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Pi=h.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:s,className:o="",children:n,iconNode:i,...l},c)=>h.createElement("svg",{ref:c,...Ni,width:t,height:t,stroke:e,strokeWidth:s?Number(r)*24/Number(t):r,className:Tt("lucide",o),...!n&&!Ci(l)&&{"aria-hidden":"true"},...l},[...i.map(([u,d])=>h.createElement(u,d)),...Array.isArray(n)?n:[n]]));const H=(e,t)=>{const r=h.forwardRef(({className:s,...o},n)=>h.createElement(Pi,{ref:n,iconNode:t,className:Tt(`lucide-${Ri(st(e))}`,`lucide-${e}`,s),...o}));return r.displayName=st(e),r};const Ii=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],Ui=H("award",Ii);const Bi=[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]],St=H("briefcase",Bi);const Oi=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Di=H("calendar",Oi);const Li=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],ki=H("chevron-right",Li);const ji=[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]],zi=H("crown",ji);const Hi=[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]],Fi=H("lightbulb",Hi);const Gi=[["path",{d:"M7.21 15 2.66 7.14a2 2 0 0 1 .13-2.2L4.4 2.8A2 2 0 0 1 6 2h12a2 2 0 0 1 1.6.8l1.6 2.14a2 2 0 0 1 .14 2.2L16.79 15",key:"143lza"}],["path",{d:"M11 12 5.12 2.2",key:"qhuxz6"}],["path",{d:"m13 12 5.88-9.8",key:"hbye0f"}],["path",{d:"M8 7h8",key:"i86dvs"}],["circle",{cx:"12",cy:"17",r:"5",key:"qbz8iq"}],["path",{d:"M12 18v-2h-.5",key:"fawc4q"}]],Vi=H("medal",Gi);const Wi=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],$i=H("star",Wi);const qi=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],Xi=H("target",qi);const Ki=[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]],Yi=H("trophy",Ki);const Zi=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Qi=H("users",Zi),Ji=()=>{const e=[{icon:a.jsx(St,{className:"w-8 h-8 text-cyan-400"}),title:"Project Management",desc:", (RFP)   ,  ,    , Agile/Waterfall  "},{icon:a.jsx(Xi,{className:"w-8 h-8 text-purple-400"}),title:"Metaverse & XR Planning",desc:"    ,  (IA/SB) ,     "},{icon:a.jsx(Qi,{className:"w-8 h-8 text-pink-400"}),title:"Communication & Tools",desc:"Jira/Redmine/Slack  , GA/SQL  , /  "},{icon:a.jsx(Fi,{className:"w-8 h-8 text-emerald-400"}),title:"Technical Understanding",desc:"Three.js/WebGL  , (Token/NFT)  , UI/UX   "}];return a.jsx("section",{className:"py-20 relative z-10 text-white",children:a.jsxs("div",{className:"container mx-auto px-6",children:[a.jsx(M.h2,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},className:"text-4xl font-bold mb-16 text-center",children:a.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-red-500 to-orange-500",children:"Core Expertise"})}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8",children:e.map((t,r)=>a.jsxs(M.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{delay:r*.1},className:"bg-white/5 backdrop-blur-sm border border-white/10 p-8 rounded-xl hover:bg-white/10 transition-all hover:scale-105",children:[a.jsx("div",{className:"mb-6 p-4 bg-black/30 rounded-full w-fit mx-auto border border-white/5",children:t.icon}),a.jsx("h3",{className:"text-xl font-bold mb-4 text-center",children:t.title}),a.jsx("p",{className:"text-gray-400 text-sm text-center leading-relaxed break-keep",children:t.desc})]},r))})]})})},en=()=>{const e=[{company:"",team:"CTS(Culture Technology Squad)  PM",period:"2023.08 - ",description:"/XR       (Project Leader)",achievements:["KOCCA R&D 'Hanok-meta'  PL:      ( A, 3.75)","TIPA R&D     PM: //    (7.5)","    PM: VR360        (1.37)","     PM:     4  (1.42)","KISTi  XR   : -       ","   ZEP  Z-World  PM: 31 /    "]},{company:"",team:"  ",period:"2021.06 - 2023.06",description:"/        ",achievements:["1o1.GG     PM:         (5)","  'Holiday'  PM: (Token/NFT)    (Whitepaper) ","NFT 'Cyber-holic'  PM:      ,  ","        "]},{company:" ",team:"",period:"2018.03 - 2019.02",description:"    ,   ",achievements:["        ","        "]}];return a.jsx("section",{className:"py-20 relative z-10 text-white",children:a.jsxs("div",{className:"container mx-auto px-6 max-w-5xl",children:[a.jsxs(M.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},className:"flex flex-col md:flex-row items-end gap-6 mb-16 border-b border-white/10 pb-8",children:[a.jsx("h2",{className:"text-4xl md:text-5xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-blue-400 to-cyan-300",children:"Experience"}),a.jsx("span",{className:"text-gray-400 font-mono text-sm mb-2",children:"// TOTAL EXPERIENCE: 5 YEARS"})]}),a.jsx("div",{className:"space-y-12",children:e.map((t,r)=>a.jsxs(M.div,{initial:{opacity:0,x:-20},whileInView:{opacity:1,x:0},viewport:{once:!0},transition:{delay:r*.1},className:"relative pl-8 md:pl-0",children:[a.jsx("div",{className:"hidden md:block absolute left-0 top-0 bottom-0 w-px bg-white/10 -ml-8 md:ml-0 md:left-[200px]"}),a.jsxs("div",{className:"flex flex-col md:flex-row gap-8",children:[a.jsxs("div",{className:"md:w-[200px] flex-shrink-0 md:text-right pt-2",children:[a.jsxs("div",{className:"flex items-center gap-2 md:justify-end text-cyan-400 font-mono font-bold mb-1",children:[a.jsx(Di,{className:"w-4 h-4"}),a.jsx("span",{children:t.period})]}),a.jsx("h3",{className:"text-xl font-bold text-white mb-1",children:t.company}),a.jsx("p",{className:"text-sm text-gray-400 mb-2",children:t.team})]}),a.jsxs("div",{className:"flex-1 bg-white/5 border border-white/10 rounded-2xl p-6 md:p-8 backdrop-blur-sm hover:bg-white/10 transition-colors",children:[a.jsxs("div",{className:"flex items-start gap-4 mb-6",children:[a.jsx("div",{className:"p-3 bg-blue-500/20 rounded-lg text-blue-400",children:a.jsx(St,{className:"w-6 h-6"})}),a.jsx("div",{children:a.jsx("h4",{className:"text-lg font-bold text-white mb-1",children:t.description})})]}),a.jsx("ul",{className:"space-y-3",children:t.achievements.map((s,o)=>a.jsxs("li",{className:"flex items-start gap-3 text-gray-300 text-sm leading-relaxed",children:[a.jsx(ki,{className:"w-4 h-4 text-cyan-500 mt-1 flex-shrink-0"}),a.jsxs("span",{children:[a.jsxs("strong",{className:"text-white/80 mr-1",children:[s.split(":")[0],":"]}),s.split(":")[1]]})]},o))})]})]})]},r))})]})})},tn=()=>{const e=[{icon:a.jsx(zi,{className:"w-8 h-8 text-yellow-400"}),title:"Grand Prize: Digital Comm.",project:"   ",org:"2024 ICT Awards",desc:"   Grand Prize "},{icon:a.jsx(Yi,{className:"w-8 h-8 text-orange-400"}),title:"Best Experience Design",project:"   ",org:"2024 Web Award Korea",desc:"   (  )"},{icon:a.jsx($i,{className:"w-8 h-8 text-purple-400"}),title:"Metaverse Sector Grand Prize",project:"  ",org:"2024 Web Award Korea",desc:"  (    )"},{icon:a.jsx(Vi,{className:"w-8 h-8 text-pink-400"}),title:"Cultural Sector Integrated Grand Prize",project:" : ",org:"2024 Web Award Korea",desc:"  (   )"},{icon:a.jsx(Ui,{className:"w-8 h-8 text-blue-400"}),title:"Digital Tech Innovation Bronze",project:" : ",org:"2024 ICT Award Korea",desc:"  Bronze Prize "}];return a.jsx("section",{className:"py-20 relative z-10 text-white",children:a.jsxs("div",{className:"container mx-auto px-6",children:[a.jsx(M.h2,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},className:"text-4xl font-bold mb-16 text-center",children:a.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-yellow-400 to-red-500",children:"Honors & Awards"})}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:e.map((t,r)=>a.jsxs(M.div,{initial:{opacity:0,x:r%2===0?-20:20},whileInView:{opacity:1,x:0},viewport:{once:!0},className:"bg-zinc-900/50 border border-white/10 p-8 rounded-2xl flex items-start gap-6 hover:border-yellow-500/50 transition-colors group",children:[a.jsx("div",{className:"bg-white/10 p-3 rounded-lg group-hover:bg-yellow-500/20 transition-colors",children:t.icon}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-bold text-white mb-1",children:t.title}),a.jsx("p",{className:"text-sm text-cyan-400 font-mono mb-1",children:t.project}),a.jsx("p",{className:"text-sm text-yellow-600 font-bold mb-3",children:t.org}),a.jsx("p",{className:"text-gray-400 leading-relaxed text-sm",children:t.desc})]})]},r))})]})})},rn=({className:e=""})=>{const t=h.useRef(null),r=h.useRef(!1);return h.useEffect(()=>{if(!(r.current||!t.current))try{typeof window<"u"&&window.adsbygoogle&&((window.adsbygoogle=window.adsbygoogle||[]).push({}),r.current=!0)}catch(s){console.log("[AdSense]    :",s)}},[]),a.jsx("div",{className:`ad-container flex justify-center items-center py-6 ${e}`,children:a.jsx("ins",{ref:t,className:"adsbygoogle",style:{display:"block",minHeight:"90px",width:"100%",maxWidth:"728px"},"data-ad-client":"ca-pub-5874227298630347","data-ad-slot":"auto","data-ad-format":"auto","data-full-width-responsive":"true"})})},sn=()=>{const e=h.useRef(null),t=h.useCallback(()=>(e.current||(e.current=new(window.AudioContext||window.webkitAudioContext)),e.current.state==="suspended"&&e.current.resume(),e.current),[]),r=h.useCallback(()=>{if(!y.getState().isMuted)try{const i=t(),l=i.createOscillator(),c=i.createGain();l.frequency.setValueAtTime(800,i.currentTime),l.frequency.exponentialRampToValueAtTime(1200,i.currentTime+.1),l.type="sine",c.gain.setValueAtTime(.05,i.currentTime),c.gain.exponentialRampToValueAtTime(.001,i.currentTime+.1),l.connect(c),c.connect(i.destination),l.start(),l.stop(i.currentTime+.1)}catch(i){console.warn("Audio FX Error:",i)}},[t]),s=h.useCallback(()=>{if(!y.getState().isMuted)try{const i=t(),l=i.createOscillator(),c=i.createGain();l.frequency.setValueAtTime(400,i.currentTime),l.frequency.exponentialRampToValueAtTime(100,i.currentTime+.15),l.type="square",c.gain.setValueAtTime(.1,i.currentTime),c.gain.exponentialRampToValueAtTime(.001,i.currentTime+.15),l.connect(c),c.connect(i.destination),l.start(),l.stop(i.currentTime+.15)}catch(i){console.warn("Audio FX Error:",i)}},[t]),o=h.useCallback(()=>{if(!y.getState().isMuted)try{const i=t(),l=i.createOscillator(),c=i.createGain();l.frequency.setValueAtTime(100,i.currentTime),l.frequency.exponentialRampToValueAtTime(800,i.currentTime+.5),l.type="sawtooth",c.gain.setValueAtTime(.05,i.currentTime),c.gain.linearRampToValueAtTime(0,i.currentTime+.5);const u=i.createBiquadFilter();u.type="lowpass",u.frequency.setValueAtTime(200,i.currentTime),u.frequency.linearRampToValueAtTime(2e3,i.currentTime+.5),l.connect(u),u.connect(c),c.connect(i.destination),l.start(),l.stop(i.currentTime+.5)}catch(i){console.warn("Audio FX Error:",i)}},[t]),n=h.useCallback(()=>{if(!y.getState().isMuted)try{const i=t(),l=i.createOscillator(),c=i.createGain();l.frequency.setValueAtTime(100,i.currentTime),l.frequency.exponentialRampToValueAtTime(2e3,i.currentTime+1.5),l.type="sawtooth",c.gain.setValueAtTime(0,i.currentTime),c.gain.linearRampToValueAtTime(.1,i.currentTime+.5),c.gain.linearRampToValueAtTime(0,i.currentTime+1.5);const u=i.createBiquadFilter();u.type="lowpass",u.frequency.setValueAtTime(200,i.currentTime),u.frequency.exponentialRampToValueAtTime(5e3,i.currentTime+1),l.connect(u),u.connect(c),c.connect(i.destination),l.start(),l.stop(i.currentTime+1.5)}catch(i){console.warn("Audio FX Error:",i)}},[t]);return{playHover:r,playClick:s,playTransition:o,playWarp:n}},nn=()=>{const e=y(s=>s.setScene),{playClick:t,playHover:r}=sn();return a.jsx(M.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-30 overflow-y-auto overflow-x-hidden bg-black/30 backdrop-blur-sm pointer-events-auto",children:a.jsx("div",{className:"w-full min-h-screen text-white selection:bg-primary/30 pb-32",children:a.jsxs("div",{className:"pt-0",children:[a.jsx("section",{id:"hero",children:a.jsx(Mi,{})}),a.jsx("section",{id:"about",children:a.jsx(Ai,{})}),a.jsx("section",{id:"work",children:a.jsx(en,{})}),a.jsx("section",{id:"expertise",children:a.jsx(Ji,{})}),a.jsx("section",{id:"achievements",children:a.jsx(tn,{})}),a.jsx(rn,{className:"bg-black/20 border-y border-white/5"}),a.jsxs("div",{className:"py-20 text-center border-t border-white/5 bg-black",children:[a.jsx("h2",{className:"text-3xl font-bold mb-6 text-white",children:"Ready to Collaborate?"}),a.jsx("p",{className:"text-gray-400 mb-8 mb-12",children:"     ."}),a.jsx("button",{onClick:()=>{t(),e("contact")},onPointerEnter:r,className:"px-8 py-4 bg-primary text-black font-bold rounded-full hover:bg-primary/80 transition-all transform hover:scale-105",children:"Contact Me (Portal)"}),a.jsx("div",{className:"mt-12 text-xs text-gray-600 font-mono",children:"SYSTEM STATUS: OPTIMAL | LOGIN: GUEST"})]})]})})})};class an extends O.Component{constructor(t){super(t),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,r){console.error("Uncaught error:",t,r),this.setState({errorInfo:r})}render(){return this.state.hasError?a.jsxs("div",{style:{padding:"20px",color:"#ff0033",backgroundColor:"black",height:"100vh",fontFamily:"monospace"},children:[a.jsx("h1",{children:"SYSTEM CRITICAL FAILURE"}),a.jsx("h2",{style:{color:"white"},children:"Metaverse OS has encountered a fatal error."}),a.jsxs("details",{style:{whiteSpace:"pre-wrap",marginTop:"20px",color:"#888"},children:[this.state.error&&this.state.error.toString(),a.jsx("br",{}),this.state.errorInfo&&this.state.errorInfo.componentStack]}),a.jsx("button",{onClick:()=>window.location.reload(),style:{marginTop:"20px",padding:"10px 20px",backgroundColor:"#333",color:"white",border:"1px solid #ff0033",cursor:"pointer"},children:"REBOOT SYSTEM"})]}):this.props.children}}const on={SYSTEM:{LOADING:"Synchronizing Dimensions..."},SECTORS:{LAB_01:{id:"LAB-01",name:"The Prism",tech:"SHADER",type:"Crystalline Planet",description:"A world of pure light and refraction.",mission:"Navigation & Orientation",status:"STABLE",visual:{color:"#06b6d4",texture:"glass",effect:"transmission"}},LAB_02:{id:"LAB-02",name:"The Terrarium",tech:"PHYSICS",type:"Living Planet",description:"An ecosystem of evolving data-forms.",mission:"Creature Analysis",status:"ACTIVE",visual:{color:"#10b981",texture:"organic",effect:"pulse"}},LAB_03:{id:"LAB-03",name:"The Resonance",tech:"AUDIO",type:"Gas Giant",description:"A storm of sound waves and frequencies.",mission:"Audio Visualization",status:"REACTIVE",visual:{color:"#facc15",texture:"gas",effect:"waves"}},LAB_04:{id:"LAB-04",name:"The Glitch",tech:"DEBUG",type:"Fractured Moon",description:"Unstable reality requiring constant patches.",mission:"Debug & Test",status:"UNSTABLE",visual:{color:"#ef4444",texture:"wireframe",effect:"glitch"}},PROFILE:{visual:{color:"#3b82f6"}}}};function ln(){const e=y(t=>t.currentScene);return h.useEffect(()=>{if(e!=="boot"){const t=new URL(window.location);t.searchParams.set("scene",e),window.history.pushState({},"",t)}else{const t=new URL(window.location);t.searchParams.delete("scene"),window.history.replaceState({},"",t)}},[e]),a.jsx(pt,{children:a.jsx(an,{children:a.jsxs("div",{className:"w-full h-screen bg-background text-text selection:bg-primary/30 selection:text-white cursor-none overflow-hidden",children:[a.jsxs(Er,{children:[a.jsx("title",{children:"Yesol Heo | Cinematic Metaverse Director"}),a.jsx("meta",{name:"description",content:"A Cinematic 3D Portfolio of Yesol Heo, Metaverse & XR Project Manager."})]}),a.jsx(wi,{}),a.jsx(Ei,{}),a.jsx(h.Suspense,{fallback:a.jsx("div",{className:"flex items-center justify-center h-screen text-white font-mono text-xl animate-pulse tracking-widest",children:on.SYSTEM.LOADING}),children:a.jsx(gi,{})}),a.jsx(Si,{}),e==="profile"&&a.jsx(nn,{})]})})})}Yt.createRoot(document.getElementById("root")).render(a.jsx(ln,{}));export{g as B,Js as C,Ys as E,on as L,fn as N,pn as Q,ti as V,Qs as a,sn as b,vn as c,mn as r,y as u,De as w};
